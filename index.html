<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cambridge B1 PET — Colegio Boston Flexible 2026</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --navy:#0a1628; --navy2:#1a2d52; --gold:#c8a84b; --green:#1a5c2e;
  --red:#8b1c1c; --cream:#faf8f3; --border:#d4c9a8; --text:#1a1a2e;
}
* { box-sizing:border-box; margin:0; padding:0; }
body { font-family:Inter,sans-serif; background:#f2ede4; color:var(--text); }

/* ── SPLASH ── */
#splash {
  position:fixed; inset:0; background:var(--navy);
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  z-index:9999; padding:24px; transition:opacity 0.5s;
}
#splash img { width:90px; height:90px; border-radius:50%; border:3px solid var(--gold); margin-bottom:20px; object-fit:cover; }
#splash h1 { font-family:"Playfair Display",serif; color:#fff; font-size:1.6rem; text-align:center; margin-bottom:6px; }
#splash p  { color:rgba(255,255,255,0.5); font-size:0.82rem; text-transform:uppercase; letter-spacing:0.08em; margin-bottom:32px; }
#splash input {
  width:100%; max-width:420px; padding:14px 18px;
  background:rgba(255,255,255,0.08); border:2px solid rgba(200,168,75,0.5);
  border-radius:10px; color:#fff; font-size:1rem; outline:none;
  font-family:Inter,sans-serif;
}
#splash input:focus { border-color:var(--gold); }
#splash input::placeholder { color:rgba(255,255,255,0.3); }
#splash button {
  margin-top:14px; width:100%; max-width:420px;
  padding:14px; background:var(--gold); border:none; border-radius:10px;
  color:var(--navy); font-size:1rem; font-weight:700; cursor:pointer;
  font-family:Inter,sans-serif;
}
#splash button:hover { background:#d4b45a; }
#splash-error { color:#ff6b6b; font-size:0.85rem; margin-top:10px; display:none; }
#splash-suggestions {
  width:100%; max-width:420px; background:#1a2d52; border:1px solid var(--gold);
  border-radius:8px; overflow:hidden; display:none; margin-top:4px;
}
.sug-item { padding:11px 16px; color:#fff; cursor:pointer; font-size:0.9rem; border-bottom:1px solid rgba(255,255,255,0.1); }
.sug-item:hover { background:rgba(200,168,75,0.2); }

/* ── TIMER ── */
#timer-bar {
  display:none; position:sticky; top:0; z-index:100;
  background:var(--navy); padding:10px 20px;
  display:none; align-items:center; justify-content:space-between;
}
#timer-display { font-family:"Playfair Display",serif; font-size:1.4rem; color:var(--gold); font-weight:700; }
#timer-display.warn { color:#ff6b6b; }
.timer-label { color:rgba(255,255,255,0.5); font-size:0.75rem; text-transform:uppercase; letter-spacing:0.08em; }
#student-info-bar { color:rgba(255,255,255,0.7); font-size:0.82rem; text-align:right; }
#version-badge { background:var(--gold); color:var(--navy); font-weight:700; font-size:0.72rem; padding:3px 10px; border-radius:20px; margin-left:8px; }

/* ── TABS ── */
#exam-body { display:none; max-width:860px; margin:0 auto; padding:20px 16px 60px; }
.tab-row { display:flex; gap:8px; margin-bottom:20px; flex-wrap:wrap; }
.tab-btn {
  padding:9px 18px; border-radius:8px; border:1.5px solid var(--border);
  background:#fff; color:var(--text); font-size:0.85rem; font-weight:600;
  cursor:pointer; transition:all 0.15s;
}
.tab-btn.active { background:var(--navy); color:var(--gold); border-color:var(--navy); }
.tab-panel { display:none; }
.tab-panel.active { display:block; }

/* ── CARDS ── */
.part-card { background:#fff; border-radius:12px; border:1px solid var(--border); padding:22px; margin-bottom:20px; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
.part-title { font-family:"Playfair Display",serif; font-size:1.05rem; font-weight:700; color:var(--navy); margin-bottom:4px; }
.part-sub { font-size:0.78rem; color:#888; margin-bottom:16px; }
.instructions { background:#f0ead8; border-left:3px solid var(--gold); padding:10px 14px; border-radius:0 6px 6px 0; font-size:0.84rem; color:#555; margin-bottom:18px; line-height:1.6; }

/* ── QUESTION BLOCKS ── */
.qblock { border:1.5px solid var(--border); border-radius:8px; padding:16px; margin-bottom:14px; background:#fff; }
.qblock.answered { border-color:#aed6b5; }
.qnum { font-size:0.7rem; font-weight:700; text-transform:uppercase; letter-spacing:0.08em; color:#aaa; margin-bottom:8px; }
.qtext { font-size:0.9rem; line-height:1.55; margin-bottom:12px; }
.signbox { background:#f8f5ee; border:1px solid #ddd; border-radius:6px; padding:14px; margin-bottom:12px; font-family:monospace; font-size:0.85rem; line-height:1.7; white-space:pre-wrap; }
.opts { display:grid; gap:7px; }
.opt {
  display:flex; align-items:flex-start; gap:10px; padding:10px 12px;
  border:1.5px solid var(--border); border-radius:7px; cursor:pointer;
  font-size:0.87rem; line-height:1.45; transition:all 0.12s; background:#fff;
}
.opt:hover { border-color:var(--gold); background:#fdf8ee; }
.opt.selected { border-color:var(--gold); background:#fef8e3; font-weight:600; }
.opt-letter {
  min-width:24px; height:24px; border-radius:50%; background:var(--navy);
  color:var(--gold); font-weight:700; font-size:0.78rem; display:flex;
  align-items:center; justify-content:center; flex-shrink:0;
}
.text-inp {
  width:220px; padding:9px 12px; border:2px solid var(--border);
  border-radius:7px; font-size:0.92rem; outline:none; font-family:Inter,sans-serif;
}
.text-inp:focus { border-color:var(--navy); }
.writing-area {
  width:100%; min-height:150px; padding:12px; border:1.5px solid var(--border);
  border-radius:8px; font-size:0.9rem; font-family:Inter,sans-serif;
  line-height:1.7; resize:vertical; outline:none;
}
.writing-area:focus { border-color:var(--navy); }
.wc { text-align:right; font-size:0.75rem; color:#aaa; margin-top:4px; }

/* ── ACTIVITIES / SENTENCES BOX ── */
.ref-box { background:#f0ead8; border:1px solid var(--gold); border-radius:8px; padding:16px 18px; margin-bottom:18px; }
.ref-box-title { font-size:0.78rem; font-weight:700; text-transform:uppercase; letter-spacing:0.08em; color:var(--navy); margin-bottom:10px; }
.ref-item { font-size:0.85rem; margin-bottom:7px; line-height:1.55; }

/* ── PROGRESS ── */
.progress-wrap { margin-bottom:20px; }
.progress-bar { height:6px; background:#e5dfc8; border-radius:3px; overflow:hidden; }
.progress-fill { height:100%; background:var(--gold); border-radius:3px; transition:width 0.3s; width:0%; }
.progress-label { font-size:0.75rem; color:#888; margin-top:5px; }

/* ── SUBMIT ── */
#submit-section { display:none; padding:24px 0 0; text-align:center; }
#submit-btn {
  padding:16px 48px; background:var(--navy); color:var(--gold);
  border:none; border-radius:10px; font-size:1rem; font-weight:700;
  cursor:pointer; font-family:Inter,sans-serif; transition:background 0.15s;
}
#submit-btn:hover { background:#0d1f3a; }

/* ── MODAL ── */
#modal-overlay {
  display:none; position:fixed; inset:0; background:rgba(0,0,0,0.7);
  z-index:9000; align-items:center; justify-content:center; padding:16px;
}
#modal-overlay.show { display:flex; }
#modal {
  background:#fff; border-radius:14px; padding:32px; max-width:560px; width:100%;
  max-height:90vh; overflow-y:auto;
}
#modal h2 { font-family:"Playfair Display",serif; color:var(--navy); margin-bottom:18px; }
.score-big { font-size:3rem; font-weight:900; color:var(--navy); font-family:"Playfair Display",serif; }
.score-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin:18px 0; }
.score-item { background:var(--cream); border:1px solid var(--border); border-radius:8px; padding:12px; }
.score-item .si-label { font-size:0.75rem; color:#888; }
.score-item .si-val   { font-size:1.1rem; font-weight:700; color:var(--navy); }
.timing-item { background:#fef9e7; border:1px solid #f6d860; }
#download-btn {
  width:100%; padding:14px; background:var(--gold); border:none; border-radius:8px;
  font-size:0.95rem; font-weight:700; color:var(--navy); cursor:pointer;
  font-family:Inter,sans-serif; margin-top:16px;
}
#pdf-status { font-size:0.82rem; color:var(--green); margin-top:8px; text-align:center; }

/* ── LISTENING ── */
.listening-notice { background:#e8f4fd; border:1px solid #90c8f0; border-radius:8px; padding:16px; font-size:0.88rem; color:#1a4a7a; }
.lq-item { margin-bottom:16px; }
.lq-label { font-size:0.85rem; font-weight:600; margin-bottom:8px; }

@media(max-width:600px) {
  .score-grid { grid-template-columns:1fr; }
  .opts { grid-template-columns:1fr; }
}
</style>
</head>
<body>

<!-- ══════════════════════════════════════════════
     SPLASH SCREEN
══════════════════════════════════════════════ -->
<div id="splash">
  <img src="data:image/png;base64,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" alt="Boston Flex">
  <h1>Cambridge B1 Preliminary</h1>
  <p>Colegio Boston Flexible &mdash; 2026</p>

  <input id="splash-input" type="text" placeholder="Type your full name..."
         oninput="onNameInput()" onkeydown="if(event.key==='Enter') doStart()">
  <div id="splash-suggestions"></div>
  <div id="splash-error"></div>
  <button onclick="doStart()">Begin Exam &#9654;</button>
  <p style="color:rgba(255,255,255,0.25);font-size:0.72rem;margin-top:24px;max-width:380px;text-align:center;">
    "Be bold, be strong for the Lord your God is with you." — Joshua 1:9
  </p>
</div>

<!-- ══════════════════════════════════════════════
     TIMER BAR
══════════════════════════════════════════════ -->
<div id="timer-bar" style="display:none;background:var(--navy);padding:10px 20px;display:none;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;">
  <div>
    <div class="timer-label">Time Remaining</div>
    <div id="timer-display">45:00</div>
  </div>
  <div id="student-info-bar">
    <span id="student-name-bar"></span>
    <span id="version-badge">Version A</span>
  </div>
</div>

<!-- ══════════════════════════════════════════════
     EXAM BODY
══════════════════════════════════════════════ -->
<div id="exam-body">
  <div class="progress-wrap">
    <div class="progress-bar"><div class="progress-fill" id="prog-fill"></div></div>
    <div class="progress-label" id="prog-label">0 / 32 reading questions answered</div>
  </div>

  <div class="tab-row">
    <button class="tab-btn active" onclick="showTab('reading',this)">&#128218; Reading</button>
    <button class="tab-btn" onclick="showTab('listening',this)">&#127911; Listening</button>
    <button class="tab-btn" onclick="showTab('writing',this)">&#9997; Writing</button>
  </div>

  <!-- READING TAB -->
  <div id="tab-reading" class="tab-panel active">
    <div id="reading-content"></div>
  </div>

  <!-- LISTENING TAB -->
  <div id="tab-listening" class="tab-panel">
    <div class="part-card">
      <div class="part-title">Listening Section</div>
      <div class="part-sub">Questions L1–L25 — Answer as you listen</div>
      <div class="listening-notice">
        &#127911; <strong>Your teacher will play the audio.</strong> Listen carefully and choose or write your answer below. Each recording is played twice.
      </div>
      <div id="listening-content" style="margin-top:18px;"></div>
    </div>
  </div>

  <!-- WRITING TAB -->
  <div id="tab-writing" class="tab-panel">
    <div id="writing-content"></div>
  </div>

  <div id="submit-section">
    <button id="submit-btn" onclick="doSubmit()">Finish &amp; Generate Report &#10003;</button>
  </div>
</div>

<!-- ══════════════════════════════════════════════
     RESULTS MODAL
══════════════════════════════════════════════ -->
<div id="modal-overlay">
  <div id="modal">
    <h2>&#127775; Exam Complete</h2>
    <div id="modal-content"></div>
  </div>
</div>

<script>
// ═══════════════════════════════════════════════════
// CONFIGURATION
// ═══════════════════════════════════════════════════
var CFG = {
  EXAM_TITLE:  "Cambridge B1 Preliminary",
  EXAM_LEVEL:  "B1",
  EXAM_GRADE:  "Grado 9",
  EXAM_YEAR:   "2026",
  PDF_SUBJECT: "PET",
  TG_TOKEN:    "8795709814:AAHy2b-MdcLDbP-0GybEZWPqSlHAe67klac",
  TG_CHAT:     "2041749428",
  EXAM_HOUR:   7,
  EXAM_MIN:    0,
  LATE_MINS:   10,
  TIMER_MINS:  45,
  READING_IDS: ["r1","r2","r3","r4","r5","r6","r7","r8","r9","r10",
                "r11","r12","r13","r14","r15","r16","r17","r18","r19","r20",
                "r21","r22","r23","r24","r25","r26","r27","r28","r29","r30","r31","r32"],
  CEFR_SCALE: [
    {max:9,  level:"A1",  desc:"Por debajo del nivel",          color:"#ef4444"},
    {max:14, level:"A2",  desc:"Elemental - acercandose a B1",  color:"#f97316"},
    {max:19, level:"A2+", desc:"Pre-intermedio",                color:"#eab308"},
    {max:24, level:"B1",  desc:"Aprueba - estandar Cambridge",  color:"#22c55e"},
    {max:28, level:"B1+", desc:"Aprueba con solidez",           color:"#16a34a"},
    {max:99, level:"B2",  desc:"Por encima del nivel",          color:"#2563eb"}
  ]
};
var TG_TOKEN   = CFG.TG_TOKEN;
var TG_CHAT    = CFG.TG_CHAT;
var EXAM_HOUR  = CFG.EXAM_HOUR;
var EXAM_MIN   = CFG.EXAM_MIN;
var LATE_MINS  = CFG.LATE_MINS;
var TIMER_SECS = CFG.TIMER_MINS * 60;

// ═══════════════════════════════════════════════════
// STUDENT ROSTER
// ═══════════════════════════════════════════════════
var STUDENTS = [
  "ALARCON OROZCO SEBASTIAN",
  "ARBELAEZ LAMADRID VICTORIA",
  "BARROS LOPEZ SOPHIA",
  "CARDENAS BALLESTEROS SOFIA",
  "CARRILLO SUAREZ LUCIANA",
  "DIAZ GUZMAN ANDRES FELIPE",
  "GARCIA SERRANO JUAN ESTEBAN",
  "IBAÑEZ GUERRA MATIAS ANGEL",
  "INSIGNARES HINCAPIE MATIAS",
  "JIMENEZ CERVANTES MIGUEL ANDRES",
  "MALAVER FLORIAN ELIZABETH DEL CARMEN",
  "MEDINA ROMERO DANNA SOFIA",
  "MEDINA VILLANUEVA KARLA ALEJANDRA",
  "MUÑOZ RODELO ESTEBAN DE JESUS",
  "NIGRO MANOTAS MARIANA SOFIA",
  "PINTO CENTENO DANIEL JESUS",
  "QUINTERO GONZALES ELIAS",
  "ROHENEZ CUELLO KEY STEPHANIE",
  "SAAVEDRA UJUETA SOFIA VALENTINA",
  "SANCHEZ ROJAS JUAN SEBASTIAN",
  "SARMIENTO ROJANO MATEO",
  "VITOLA CARRASCAL SOFIA",
  "YEPES PACHECO ALEJANDRO DAVID",
  "CHAPARRO DE LA HOZ MARILYN SOFIA",
  "EMANUEL ARCILA PEREZ"
];

var CODES = {
  "ALARCON OROZCO SEBASTIAN":"65037256",
  "ARBELAEZ LAMADRID VICTORIA":"81629684",
  "BARROS LOPEZ SOPHIA":"52363072",
  "CARDENAS BALLESTEROS SOFIA":"83051790",
  "CARRILLO SUAREZ LUCIANA":"15943311",
  "DIAZ GUZMAN ANDRES FELIPE":"26852396",
  "GARCIA SERRANO JUAN ESTEBAN":"96015892",
  "IBAÑEZ GUERRA MATIAS ANGEL":"44052172",
  "INSIGNARES HINCAPIE MATIAS":"95405261",
  "JIMENEZ CERVANTES MIGUEL ANDRES":"51057428",
  "MALAVER FLORIAN ELIZABETH DEL CARMEN":"55776676",
  "MEDINA ROMERO DANNA SOFIA":"74728229",
  "MEDINA VILLANUEVA KARLA ALEJANDRA":"56976156",
  "MUÑOZ RODELO ESTEBAN DE JESUS":"14128567",
  "NIGRO MANOTAS MARIANA SOFIA":"29588843",
  "PINTO CENTENO DANIEL JESUS":"65913299",
  "QUINTERO GONZALES ELIAS":"60547107",
  "ROHENEZ CUELLO KEY STEPHANIE":"66037555",
  "SAAVEDRA UJUETA SOFIA VALENTINA":"50694331",
  "SANCHEZ ROJAS JUAN SEBASTIAN":"51025696",
  "SARMIENTO ROJANO MATEO":"58483541",
  "VITOLA CARRASCAL SOFIA":"69540778",
  "YEPES PACHECO ALEJANDRO DAVID":"95270297",
  "CHAPARRO DE LA HOZ MARILYN SOFIA":"90763040",
  "EMANUEL ARCILA PEREZ":"15558937"
};

// ═══════════════════════════════════════════════════
// STATE
// ═══════════════════════════════════════════════════
var answers    = {};
var startTime  = null;
var endTime    = null;
var timerID    = null;
var secsLeft   = TIMER_SECS;
var activeVer  = "A";
var activeKey  = {};
var activeP6   = {};
var studentName = "";
var studentCode = "";

// ═══════════════════════════════════════════════════
// NORMALIZE (handles Ñ, accents, case)
// ═══════════════════════════════════════════════════
function norm(s) {
  if (!s) return "";
  s = s.toUpperCase().trim();
  s = s.replace(/ñ/g, "~~N~~").replace(/Ñ/g, "~~N~~");
  if (s.normalize) {
    s = s.normalize("NFD").replace(/[̀-ͯ]/g, "");
  }
  s = s.replace(/~~N~~/g, "Ñ");
  s = s.replace(/\s+/g, " ");
  return s;
}

// ═══════════════════════════════════════════════════
// SPLASH LOGIC
// ═══════════════════════════════════════════════════
function onNameInput() {
  var val  = document.getElementById("splash-input").value;
  var norm_val = norm(val);
  var box  = document.getElementById("splash-suggestions");
  document.getElementById("splash-error").textContent = "";
  if (norm_val.length < 2) { box.style.display = "none"; return; }
  var hits = STUDENTS.filter(function(s){ return norm(s).indexOf(norm_val) !== -1; });
  if (!hits.length) { box.style.display = "none"; return; }
  box.innerHTML = "";
  hits.forEach(function(s) {
    var d = document.createElement("div");
    d.className = "sug-item";
    d.textContent = s;
    // mousedown+touchstart fire before blur — fixes mobile tap issue
    var selectFn = (function(name){ return function(e){
      e.preventDefault();
      document.getElementById("splash-input").value = name;
      document.getElementById("splash-suggestions").style.display = "none";
      document.getElementById("splash-error").textContent = "";
    }; })(s);
    d.addEventListener("mousedown",  selectFn);
    d.addEventListener("touchstart", selectFn, {passive:false});
    box.appendChild(d);
  });
  box.style.display = "block";
}

function doStart() {
  var raw   = document.getElementById("splash-input").value;
  var errEl = document.getElementById("splash-error");
  var normRaw = norm(raw);

  // 1) Exact match
  var match = STUDENTS.filter(function(s){ return norm(s) === normRaw; });

  // 2) If no exact match, try "starts with" or "contains" — pick the unique hit
  if (!match.length && normRaw.length >= 3) {
    var partial = STUDENTS.filter(function(s){ return norm(s).indexOf(normRaw) !== -1; });
    if (partial.length === 1) match = partial;  // only accept if unambiguous
  }

  // 3) Last resort: first name only match (e.g. just "BARROS LOPEZ SOPHIA" typed as "SOPHIA BARROS")
  // Split typed words and check all appear in student name
  if (!match.length && normRaw.length >= 3) {
    var words = normRaw.split(" ").filter(function(w){ return w.length > 1; });
    var wordMatch = STUDENTS.filter(function(s){
      var sn = norm(s);
      return words.every(function(w){ return sn.indexOf(w) !== -1; });
    });
    if (wordMatch.length === 1) match = wordMatch;
  }

  if (!match.length) {
    // Clear input and show friendly Spanish message
    document.getElementById("splash-input").value = "";
    document.getElementById("splash-suggestions").style.display = "none";
    errEl.style.color = "#ff6b6b";
    errEl.textContent = "El alumno ingresado no existe en el listado del curso. Por favor escribe tu apellido y selecciona tu nombre de la lista.";
    errEl.style.display = "block";
    document.getElementById("splash-input").focus();
    return;
  }
  errEl.style.display = "none";
  studentName = match[0];
  studentCode = CODES[studentName] || "00000000";
  startTime   = new Date();

  // Assign version
  var h = 0;
  for (var i = 0; i < studentName.length; i++) {
    h = ((h << 5) - h) + studentName.charCodeAt(i);
    h = h | 0;
  }
  activeVer = ["A","B","C"][Math.abs(h) % 3];

  // Build exam
  buildExam(activeVer);

  // Show UI
  document.getElementById("splash").style.opacity = "0";
  setTimeout(function() {
    document.getElementById("splash").style.display = "none";
    document.getElementById("timer-bar").style.display = "flex";
    document.getElementById("exam-body").style.display = "block";
    document.getElementById("submit-section").style.display = "block";
  }, 500);

  document.getElementById("student-name-bar").textContent = studentName + " ";
  document.getElementById("version-badge").textContent = "Version " + activeVer;
  startTimer();
  checkLate();

  // ── SURVEILLANCE EVENTS ──────────────────────────────
  // Throttle: only send one alert per 30 seconds max
  var lastAlertTime = 0;

  function syncTg(msg) {
    // Synchronous XHR — guaranteed to fire even in beforeunload
    try {
      var x = new XMLHttpRequest();
      x.open("POST", "https://api.telegram.org/bot" + TG_TOKEN + "/sendMessage", false);
      x.setRequestHeader("Content-Type", "application/json");
      x.send(JSON.stringify({ chat_id: TG_CHAT, text: msg }));
    } catch(e) {}
  }

  function alertTeacher(reason) {
    if (endTime) return; // exam already finished — no alert needed
    var now     = Date.now();
    if (now - lastAlertTime < 30000) return; // throttle: max 1 alert / 30s
    lastAlertTime = now;
    var elapsed = Math.round((now - startTime.getTime()) / 60000);
    var ts      = new Date().toLocaleTimeString("es-CO");
    syncTg(
      "[ALERTA TRAMPA] PET 2026\n" +
      "Codigo: #" + studentCode + "\n" +
      "Evento: " + reason + "\n" +
      "Hora: " + ts + "\n" +
      "Minutos transcurridos: " + elapsed + "\n" +
      "Colegio Boston Flexible"
    );
  }

  // 1) Tab hidden / app minimized / screen locked
  document.addEventListener("visibilitychange", function() {
    if (document.hidden) {
      alertTeacher("Cambio de pestana / pantalla oculta");
    }
  });

  // 2) Window loses focus (Alt+Tab, click outside, another app)
  window.addEventListener("blur", function() {
    alertTeacher("Ventana sin foco (alt+tab u otra app)");
  });

  // 3) Fullscreen exited (pressed Escape or swiped out)
  document.addEventListener("fullscreenchange", function() {
    if (!document.fullscreenElement && startTime && !endTime) {
      alertTeacher("Salio del modo pantalla completa");
      // Try to re-enter fullscreen
      setTimeout(function() {
        try { document.documentElement.requestFullscreen(); } catch(e) {}
      }, 1000);
    }
  });

  // 4) Right-click disabled
  document.addEventListener("contextmenu", function(e) {
    if (startTime && !endTime) e.preventDefault();
  });

  // 5) Common cheat shortcuts blocked (F12, Ctrl+U, Ctrl+Shift+I, Ctrl+C in some cases)
  document.addEventListener("keydown", function(e) {
    if (!startTime || endTime) return;
    if (e.key === "F12" ||
       (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
       (e.ctrlKey && e.key === "u")) {
      e.preventDefault();
      alertTeacher("Intento de abrir herramientas del navegador ("+e.key+")");
    }
  });

  // 6) Window close / navigate away
  window.onbeforeunload = function() {
    alertTeacher("Cerro o recargo la pagina");
    if (!endTime) {
      return "El examen no ha sido enviado. Si sales perderás tu progreso.";
    }
  };
  try { document.documentElement.requestFullscreen(); } catch(e) {}
}

// ═══════════════════════════════════════════════════
// TIMER
// ═══════════════════════════════════════════════════
function startTimer() {
  timerID = setInterval(function() {
    secsLeft--;
    if (secsLeft < 0) secsLeft = 0;
    var m = Math.floor(secsLeft / 60);
    var s = secsLeft % 60;
    var el = document.getElementById("timer-display");
    el.textContent = (m < 10 ? "0" : "") + m + ":" + (s < 10 ? "0" : "") + s;
    if (secsLeft <= 300) el.classList.add("warn");
    if (secsLeft === 0) { clearInterval(timerID); doSubmit(); }
  }, 1000);
}

// ═══════════════════════════════════════════════════
// TABS
// ═══════════════════════════════════════════════════
function showTab(id, btn) {
  document.querySelectorAll(".tab-panel").forEach(function(p){ p.classList.remove("active"); });
  document.querySelectorAll(".tab-btn").forEach(function(b){ b.classList.remove("active"); });
  document.getElementById("tab-" + id).classList.add("active");
  btn.classList.add("active");
}

// ═══════════════════════════════════════════════════
// ANSWER RECORDING
// ═══════════════════════════════════════════════════
function pick(qid, val, el) {
  answers[qid] = val;
  var block = document.getElementById("qb-" + qid);
  if (block) {
    var opts = block.querySelectorAll(".opt");
    for (var i = 0; i < opts.length; i++) opts[i].classList.remove("selected");
    if (el) el.classList.add("selected");
    block.classList.add("answered");
  }
  updateProgress();
}

function typeAnswer(qid, val) {
  answers[qid] = val;
  var block = document.getElementById("qb-" + qid);
  if (block && val.trim()) block.classList.add("answered");
  updateProgress();
}

function updateProgress() {
  var count = 0;
  var keys = ["r1","r2","r3","r4","r5","r6","r7","r8","r9","r10",
              "r11","r12","r13","r14","r15","r16","r17","r18","r19","r20",
              "r21","r22","r23","r24","r25","r26","r27","r28","r29","r30","r31","r32"];
  for (var i = 0; i < keys.length; i++) {
    if (answers[keys[i]] && answers[keys[i]].trim() !== "") count++;
  }
  document.getElementById("prog-fill").style.width = Math.round((count/32)*100) + "%";
  document.getElementById("prog-label").textContent = count + " / 32 reading questions answered";
}

// ═══════════════════════════════════════════════════
// TELEGRAM
// ═══════════════════════════════════════════════════
function tgSend(msg) {
  fetch("https://api.telegram.org/bot" + TG_TOKEN + "/sendMessage", {
    method:"POST", headers:{"Content-Type":"application/json"},
    body: JSON.stringify({chat_id: TG_CHAT, text: msg})
  }).catch(function(){});
}

function checkLate() {
  var now   = new Date();
  var sched = new Date();
  sched.setHours(EXAM_HOUR, EXAM_MIN, 0, 0);
  var diff  = Math.round((now - sched) / 60000);
  var ts    = now.toLocaleTimeString("es-CO");
  if (diff > LATE_MINS) {
    tgSend("[ALERTA INICIO TARDIO] PET 2026\nCodigo: #" + studentCode + "\nHora: " + ts + "\nTarde: " + diff + " min\nBoston Flexible");
  } else {
    tgSend("[INICIO OK] PET 2026\nCodigo: #" + studentCode + "\nHora: " + ts + "\nBoston Flexible");
  }
}

// ═══════════════════════════════════════════════════
// SCORING
// ═══════════════════════════════════════════════════
function calcScores() {
  var p1=0,p2=0,p3=0,p4=0,p5=0,p6=0;
  for (var i=1;i<=5;i++)  if (answers["r"+i]  && answers["r"+i]  === activeKey["r"+i])  p1++;
  for (var i=6;i<=10;i++) if (answers["r"+i]  && answers["r"+i]  === activeKey["r"+i])  p2++;
  for (var i=11;i<=15;i++)if (answers["r"+i]  && answers["r"+i]  === activeKey["r"+i])  p3++;
  for (var i=16;i<=20;i++)if (answers["r"+i]  && answers["r"+i]  === activeKey["r"+i])  p4++;
  for (var i=21;i<=26;i++)if (answers["r"+i]  && answers["r"+i]  === activeKey["r"+i])  p5++;
  var p6keys = Object.keys(activeP6);
  for (var k=0;k<p6keys.length;k++) {
    var kid = p6keys[k];
    if (answers[kid] && answers[kid].toLowerCase().trim() === activeP6[kid]) p6++;
  }
  var readTotal = p1+p2+p3+p4+p5+p6;
  var ta1 = document.getElementById("writing1") ? (document.getElementById("writing1").value || "") : "";
  var ta2 = document.getElementById("writing2") ? (document.getElementById("writing2").value || "") : "";
  var ta3 = document.getElementById("writing3") ? (document.getElementById("writing3").value || "") : "";
  return {p1:p1,p2:p2,p3:p3,p4:p4,p5:p5,p6:p6,read:readTotal,w1:ta1,w2:ta2,w3:ta3};
}

// ═══════════════════════════════════════════════════
// SUBMIT
// ═══════════════════════════════════════════════════
function doSubmit() {
  clearInterval(timerID);
  endTime = new Date();
  var sc  = calcScores();
  var dur = Math.round((endTime - startTime) / 60000);
  var ts  = endTime.toLocaleTimeString("es-CO");

  tgSend("[FIN] PET 2026\nCodigo: #" + studentCode + "\nInicio: " + startTime.toLocaleTimeString("es-CO") + "\nFin: " + ts + "\nDuracion: " + dur + " min\nReading: " + sc.read + "/32\nBoston Flexible");

  var html = "<div class='score-big'>" + sc.read + "<span style='font-size:1.2rem;color:#888;'>/32</span></div>";
  html += "<p style='color:#888;font-size:0.85rem;margin:6px 0 18px;'>Reading Score (auto-graded)</p>";
  html += "<div class='score-grid'>";
  html += "<div class='score-item'><div class='si-label'>Part 1 – Signs</div><div class='si-val'>" + sc.p1 + "/5</div></div>";
  html += "<div class='score-item'><div class='si-label'>Part 2 – Matching</div><div class='si-val'>" + sc.p2 + "/5</div></div>";
  html += "<div class='score-item'><div class='si-label'>Part 3 – Long Text</div><div class='si-val'>" + sc.p3 + "/5</div></div>";
  html += "<div class='score-item'><div class='si-label'>Part 4 – Gapped Text</div><div class='si-val'>" + sc.p4 + "/5</div></div>";
  html += "<div class='score-item'><div class='si-label'>Part 5 – MC Cloze</div><div class='si-val'>" + sc.p5 + "/6</div></div>";
  html += "<div class='score-item'><div class='si-label'>Part 6 – Open Cloze</div><div class='si-val'>" + sc.p6 + "/6</div></div>";
  html += "<div class='score-item timing-item'><div class='si-label'>Start Time</div><div class='si-val'>" + startTime.toLocaleTimeString("es-CO") + "</div></div>";
  html += "<div class='score-item timing-item'><div class='si-label'>End Time</div><div class='si-val'>" + ts + "</div></div>";
  html += "<div class='score-item timing-item'><div class='si-label'>Duration</div><div class='si-val'>" + dur + " min</div></div>";
  html += "<div class='score-item timing-item'><div class='si-label'>Version</div><div class='si-val'>Version " + activeVer + "</div></div>";
  html += "</div>";
  // CEFR scale based on reading score out of 32
  // B1 Preliminary reading: 32 questions
  // Score guide (approximate, aligned to Cambridge):
  // 0-9   → A1 (below A2)
  // 10-14 → A2 (Elementary)
  // 15-19 → A2+ / B1 entry
  // 20-24 → B1 (Preliminary — pass)
  // 25-28 → B1+ (solid pass)
  // 29-32 → B2 (above exam level)
  var cefrLevel, cefrDesc, cefrColor;
  if (sc.read <= 9)       { cefrLevel="A1";  cefrDesc="Below exam level — needs significant improvement"; cefrColor="#ef4444"; }
  else if (sc.read <= 14) { cefrLevel="A2";  cefrDesc="Elementary — approaching B1"; cefrColor="#f97316"; }
  else if (sc.read <= 19) { cefrLevel="A2+"; cefrDesc="Pre-intermediate — just below B1 threshold"; cefrColor="#eab308"; }
  else if (sc.read <= 24) { cefrLevel="B1";  cefrDesc="Preliminary pass — meets Cambridge B1 standard"; cefrColor="#22c55e"; }
  else if (sc.read <= 28) { cefrLevel="B1+"; cefrDesc="Solid B1 — strong pass"; cefrColor="#16a34a"; }
  else                    { cefrLevel="B2";  cefrDesc="Upper-intermediate — above exam level"; cefrColor="#2563eb"; }

  html += "<div style='background:#f9f6ee;border:1.5px solid #d4c9a8;border-radius:10px;padding:16px;margin:14px 0;'>";
  html += "<div style='font-size:0.72rem;font-weight:700;text-transform:uppercase;letter-spacing:0.08em;color:#888;margin-bottom:8px;'>CEFR Level Estimate (Reading)</div>";
  html += "<div style='display:flex;align-items:center;gap:14px;'>";
  html += "<div style='font-family:serif;font-size:2.4rem;font-weight:900;color:" + cefrColor + ";line-height:1;'>" + cefrLevel + "</div>";
  html += "<div style='font-size:0.84rem;color:#555;line-height:1.5;'>" + cefrDesc + "<br><span style='font-size:0.75rem;color:#aaa;'>Based on Reading score " + sc.read + "/32 · Listening & Writing may affect final level</span></div>";
  html += "</div>";
  // Visual bar
  html += "<div style='margin-top:12px;'>";
  html += "<div style='display:flex;justify-content:space-between;font-size:0.68rem;color:#aaa;margin-bottom:4px;'><span>A1</span><span>A2</span><span>A2+</span><span>B1</span><span>B1+</span><span>B2</span></div>";
  html += "<div style='height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;'>";
  html += "<div style='height:100%;width:" + Math.round((sc.read/32)*100) + "%;background:" + cefrColor + ";border-radius:4px;transition:width 0.8s;'></div>";
  html += "</div></div></div>";

  html += "<p style='font-size:0.82rem;color:#555;background:#f9f6ee;border-radius:8px;padding:12px;margin-bottom:4px;'>Download your PDF and email it to <strong>edoardoortiz@redboston.edu.co</strong></p>";
  html += "<div id='pdf-status' style='font-size:0.85rem;color:#1a5c2e;background:#ecfdf5;border:1px solid #6ee7b7;border-radius:8px;padding:12px;text-align:center;'>&#9203; Generating your PDF report automatically...</div>";
  html += "<div id='pdf-status'></div>";

  document.getElementById("modal-content").innerHTML = html;
  document.getElementById("modal-overlay").classList.add("show");

  // Store for PDF
  window.examResult = {name:studentName, code:studentCode, ver:activeVer,
    scores:sc, dur:dur, start:startTime.toLocaleTimeString("es-CO"), end:ts};

  // Auto-generate PDF immediately — student cannot skip this
  setTimeout(function() { genPDF(); }, 800);
}

// ═══════════════════════════════════════════════════
// PDF GENERATION + AUTO EMAIL
// El PDF usa SOLO el código — sin nombre del alumno
// Se envía automáticamente por email al profesor
// ═══════════════════════════════════════════════════
async function genPDF() {
  var st = document.getElementById("pdf-status");
  if (st) st.innerHTML = "&#9203; Generando reporte... por favor espera.";
  try {
    var r  = window.examResult;
    var sc = r.scores;

    // ── BUILD PDF ────────────────────────────────────
    var doc  = await PDFLib.PDFDocument.create();
    var page = doc.addPage([595,842]);
    var font = await doc.embedFont(PDFLib.StandardFonts.Helvetica);
    var bold = await doc.embedFont(PDFLib.StandardFonts.HelveticaBold);
    var draw = function(text, x, y, size, f, color) {
      page.drawText(String(text), {x:x, y:y, size:size||11, font:f||font,
        color:color||PDFLib.rgb(0.1,0.1,0.15)});
    };

    // Header
    page.drawRectangle({x:0,y:782,width:595,height:60,color:PDFLib.rgb(0.04,0.09,0.15)});
    draw("Cambridge B1 Preliminary — PET 2026", 30, 808, 14, bold, PDFLib.rgb(0.78,0.66,0.29));
    draw("Colegio Boston Flexible", 30, 792, 9, font, PDFLib.rgb(0.6,0.6,0.6));

    // Student info — ONLY code, no name
    draw("Codigo:",   40, 755, 9, bold); draw("#" + r.code, 120, 755, 9);
    draw("Version:",  40, 740, 9, bold); draw("Version " + r.ver, 120, 740, 9);
    draw("Inicio:",   40, 725, 9, bold); draw(r.start, 120, 725, 9);
    draw("Fin:",      40, 710, 9, bold); draw(r.end,   120, 710, 9);
    draw("Duracion:", 40, 695, 9, bold); draw(r.dur + " minutos", 120, 695, 9);

    // Score box
    page.drawRectangle({x:30,y:635,width:535,height:48,
      color:PDFLib.rgb(0.97,0.96,0.93),
      borderColor:PDFLib.rgb(0.78,0.66,0.29), borderWidth:1});
    draw("READING TOTAL:", 45, 660, 12, bold);
    draw(sc.read + " / 32", 200, 660, 18, bold, PDFLib.rgb(0.04,0.09,0.15));
    var cefrPdf = sc.read<=9?"A1":sc.read<=14?"A2":sc.read<=19?"A2+":sc.read<=24?"B1":sc.read<=28?"B1+":"B2";
    draw("CEFR: " + cefrPdf, 360, 660, 12, bold, PDFLib.rgb(0.04,0.36,0.12));

    // Part breakdown
    var parts = [["Part 1",sc.p1,5],["Part 2",sc.p2,5],["Part 3",sc.p3,5],
                 ["Part 4",sc.p4,5],["Part 5",sc.p5,6],["Part 6",sc.p6,6]];
    var px = 40, py = 618;
    parts.forEach(function(p) {
      draw(p[0]+": "+p[1]+"/"+p[2], px, py, 8, font);
      px += 92; if (px > 500) { px = 40; py -= 13; }
    });

    // Writing section
    page.drawLine({start:{x:30,y:575},end:{x:565,y:575},
      thickness:0.5, color:PDFLib.rgb(0.8,0.8,0.8)});
    draw("WRITING — Para calificar por el profesor", 40, 560, 10, bold);
    var wy = 542;
    var writeSection = function(label, text) {
      if (!text || !text.trim()) return;
      draw(label, 40, wy, 9, bold); wy -= 13;
      var lines = text.substring(0, 600).match(/.{1,88}/g) || [];
      lines.forEach(function(l) { draw(l.trim(), 50, wy, 7.5); wy -= 11; });
      wy -= 8;
    };
    writeSection("Part 1 — Email:", sc.w1);
    writeSection("Part 2A — Article:", sc.w2);
    writeSection("Part 2B — Story:", sc.w3);

    // Footer
    draw("Generado: " + new Date().toLocaleString("es-CO"), 30, 18, 7, font, PDFLib.rgb(0.6,0.6,0.6));
    draw("Confidencial — Solo para: edoardoortiz@redboston.edu.co", 200, 18, 7, font, PDFLib.rgb(0.6,0.6,0.6));

    // Save
    var bytes;
    try {
      bytes = await doc.save({userPassword:"", ownerPassword:"$$Bella_13832726$$"});
    } catch(e2) {
      bytes = await doc.save();
    }

    // ── CONVERT TO BASE64 ────────────────────────────
    var binary = "";
    var uBytes = new Uint8Array(bytes);
    for (var i = 0; i < uBytes.length; i++) binary += String.fromCharCode(uBytes[i]);
    var b64 = btoa(binary);

    var fileName = "PET_" + r.code + "_" + r.ver + ".pdf";
    if (st) st.innerHTML = "&#9203; Enviando reporte al profesor...";

    // ── SEND PDF VIA TELEGRAM BOT (sendDocument) ─────
    // Convert base64 to Blob for multipart upload
    var pdfBlob = new Blob([bytes], {type:"application/pdf"});
    var formData = new FormData();
    formData.append("chat_id", TG_CHAT);
    formData.append("caption",
      "[REPORTE FINAL] PET 2026\n" +
      "Codigo: #" + r.code + "\n" +
      "Version: " + r.ver + "\n" +
      "Reading: " + sc.read + "/32 — CEFR: " + cefrPdf + "\n" +
      "P1:" + sc.p1 + " P2:" + sc.p2 + " P3:" + sc.p3 +
      " P4:" + sc.p4 + " P5:" + sc.p5 + " P6:" + sc.p6 + "\n" +
      "Inicio: " + r.start + " | Fin: " + r.end + " | " + r.dur + " min\n" +
      "Colegio Boston Flexible"
    );
    formData.append("document", pdfBlob, fileName);

    var tgResp = await fetch(
      "https://api.telegram.org/bot" + TG_TOKEN + "/sendDocument",
      { method: "POST", body: formData }
    );
    var tgJson = await tgResp.json();

    // ── LOCAL DOWNLOAD as backup ──────────────────────
    var blob2 = new Blob([bytes], {type:"application/pdf"});
    var url   = URL.createObjectURL(blob2);
    var a     = document.createElement("a");
    a.href = url; a.download = fileName; a.click();

    if (tgJson.ok) {
      if (st) st.innerHTML =
        "<div style='background:#ecfdf5;border:1px solid #6ee7b7;border-radius:8px;padding:14px;text-align:center;'>" +
        "<div style='font-size:1.3rem;'>&#10003;</div>" +
        "<strong style='color:#16a34a;'>Reporte enviado al profesor</strong><br>" +
        "<span style='font-size:0.8rem;color:#555;'>El PDF fue enviado directamente al profesor.<br>" +
        "Codigo del reporte: <strong>#" + r.code + "</strong> — Tu nombre no aparece.</span><br><br>" +
        "<button onclick='genPDF()' style='padding:7px 16px;background:#0a1628;color:#c8a84b;border:none;" +
        "border-radius:6px;cursor:pointer;font-size:0.8rem;font-weight:700;'>&#8595; Descargar copia</button>" +
        "</div>";
    } else {
      // Telegram failed — show local download confirmation
      if (st) st.innerHTML =
        "<div style='background:#fef9e7;border:1px solid #f6d860;border-radius:8px;padding:14px;'>" +
        "<strong style='color:#d97706;'>&#10003; PDF descargado localmente.</strong><br>" +
        "<span style='font-size:0.8rem;'>Error al enviar: " + (tgJson.description||"sin conexión") + "<br>" +
        "Archivo: <strong>" + fileName + "</strong></span><br><br>" +
        "<button onclick='genPDF()' style='padding:7px 16px;background:#0a1628;color:#c8a84b;border:none;" +
        "border-radius:6px;cursor:pointer;font-size:0.8rem;font-weight:700;'>&#8635; Reintentar envío</button>" +
        "</div>";
    }

  } catch(e) {
    if (st) st.innerHTML =
      "<span style='color:#dc2626;'>Error: " + e.message + "</span><br>" +
      "<button onclick='genPDF()' style='padding:10px 22px;background:#0a1628;color:#c8a84b;border:none;border-radius:6px;cursor:pointer;font-weight:700;margin-top:8px;'>&#8635; Reintentar</button>";
    console.error(e);
  }
}

// ═══════════════════════════════════════════════════
// EXAM BANK — VERSION A, B, C
// ═══════════════════════════════════════════════════

var BANK = {
  A: {
    key: {"r1": "B", "r2": "C", "r3": "A", "r4": "B", "r5": "C", "r6": "E", "r7": "A", "r8": "G", "r9": "C", "r10": "F", "r11": "B", "r12": "D", "r13": "A", "r14": "C", "r15": "B", "r16": "D", "r17": "B", "r18": "F", "r19": "A", "r20": "G", "r21": "C", "r22": "A", "r23": "D", "r24": "B", "r25": "C", "r26": "A", "r27": "which", "r28": "been", "r29": "more", "r30": "as", "r31": "no", "r32": "than"},
    p1: {"inst": "Look at the text in each question. What does it say? Choose the correct letter A, B or C.", "qs": [{"id": "r1", "sign": "SWIMMING POOL\nLane 3 reserved for competitive training\nTuesday & Thursday 4\u20136 pm\nAll other lanes open to the public", "q": "What does this notice tell swimmers?", "opts": {"A": "The pool is closed on Tuesdays and Thursdays.", "B": "One lane cannot be used by the general public at certain times.", "C": "Competitive swimmers must book lane 3 in advance."}}, {"id": "r2", "sign": "Message from Mum:\nDinner is in the fridge. Heat it for 3 mins.\nDon't forget \u2014 football kit needs washing tonight!\nBack by 9.", "q": "What does Mum want her child to do?", "opts": {"A": "Cook dinner before she gets home.", "B": "Go to football practice this evening.", "C": "Put the football clothes in the washing machine."}}, {"id": "r3", "sign": "CITY LIBRARY\nNew members receive a free tote bag this month only.\nBring proof of address to register.", "q": "What must new members do to get the free bag?", "opts": {"A": "Show a document that proves where they live.", "B": "Register online before visiting the library.", "C": "Visit the library before the end of the year."}}, {"id": "r4", "sign": "Caf\u00e9 Marino \u2014 Staff Notice\nPlease remind customers that outside food\nmay NOT be consumed on the premises.\nThank you for your cooperation.", "q": "What are staff asked to tell customers?", "opts": {"A": "They must buy food from the caf\u00e9 before sitting down.", "B": "They are not allowed to eat food they have brought with them.", "C": "Outside drinks are welcome but food from home is not."}}, {"id": "r5", "sign": "To: All Year 9 students\nThe science trip to the nature reserve\nhas been moved to Friday 14th.\nParent permission forms due Wednesday.", "q": "What has changed about the science trip?", "opts": {"A": "Students need to collect permission forms on Friday.", "B": "The trip now requires an extra payment from parents.", "C": "The date of the trip is different from the original plan."}}]},
    p2: {"inst": "The people below are all looking for a weekend activity. Decide which activity (A\u2013H) would be most suitable for each person. Choose the correct letter.", "people": [{"id": "r6", "name": "Laura", "desc": "Laura loves being outdoors and enjoys physical challenges. She has never tried water sports but wants to start something new this weekend with a small group of friends."}, {"id": "r7", "name": "Daniel", "desc": "Daniel is interested in history and art. He prefers quiet, indoor activities and would like to learn something new that he can continue as a hobby at home."}, {"id": "r8", "name": "Sofia", "desc": "Sofia is very competitive and plays team sports regularly. She wants a fast-paced activity where she can test her skills against others her age."}, {"id": "r9", "name": "Mateo", "desc": "Mateo enjoys cooking and trying food from different cultures. He would like a relaxed activity where he can socialise and pick up practical skills."}, {"id": "r10", "name": "Valeria", "desc": "Valeria is passionate about the environment. She wants to spend the day doing something useful for the local community and meet like-minded people."}], "acts": [{"l": "A", "title": "Watercolour Painting Workshop", "desc": "A three-hour indoor session for beginners. Learn basic techniques and take your finished artwork home. All materials provided."}, {"l": "B", "title": "City Walking Tour", "desc": "A guided two-hour walk through the historic centre. Suitable for all ages. Comfortable shoes recommended."}, {"l": "C", "title": "Basketball Tournament", "desc": "Open to players aged 13\u201318. Teams of five compete in a round-robin format. Prizes for the top three teams."}, {"l": "D", "title": "Photography Walk", "desc": "Explore local parks with a professional photographer. Suitable for smartphone users and camera owners alike."}, {"l": "E", "title": "Introduction to Kayaking", "desc": "A beginner-friendly session on the river. Safety equipment provided. Maximum eight participants per group."}, {"l": "F", "title": "Beach Clean-up Day", "desc": "Join local volunteers to collect litter from the coastline. Gloves and bags provided. Refreshments included."}, {"l": "G", "title": "Inter-school Football League", "desc": "A full-day tournament for school teams. Fast-paced matches on full-sized pitches. Registration required."}, {"l": "H", "title": "International Food Fair & Cooking Demo", "desc": "Sample dishes from around the world and watch live cooking demonstrations. Informal workshops throughout the day."}]},
    p3: {"inst": "Read the article and choose the correct answer A, B, C or D.", "title": "The App That Changed How We Travel", "text": "Five years ago, planning a trip abroad meant hours spent searching multiple websites, comparing prices and hoping the information was accurate. Today, a single app can do all of that in seconds \u2014 and often more reliably than any travel agent. The rise of AI-powered travel platforms has transformed the industry completely.\n\nThese apps do not simply list flights and hotels. They analyse your preferences, suggest personalised itineraries, warn you about local weather patterns and even recommend restaurants based on your dietary needs. For frequent travellers, this level of personalisation was once available only to those who could afford a private travel consultant.\n\nNot everyone, however, is enthusiastic. Many tourism professionals worry that over-reliance on algorithms removes the human element from travel. 'A good travel agent knows when a client is stressed and adjusts their recommendations accordingly,' says Maria Fuentes, who has worked in the industry for twenty years. 'An app cannot do that \u2014 not yet, anyway.'\n\nThere are also concerns about data privacy. These platforms collect enormous amounts of personal information, and not all users read the terms carefully before agreeing. Consumer groups have called for stricter regulation to ensure travellers understand exactly what they are sharing.\n\nDespite these concerns, the popularity of AI travel apps continues to grow rapidly. For many users, the convenience outweighs the drawbacks. Whether this technology ultimately improves or diminishes the experience of travel remains, for now, an open question.", "qs": [{"id": "r11", "q": "According to the article, what has changed most about trip planning?", "opts": {"A": "It now requires travellers to visit multiple agencies in person.", "B": "Technology has made it faster and more personalised than before.", "C": "Travel agents have become more popular as a result of new apps.", "D": "Most travellers now prefer to plan trips without any technology."}}, {"id": "r12", "q": "What does Maria Fuentes suggest about travel apps?", "opts": {"A": "They are already better than human travel agents in most situations.", "B": "They collect too much personal data from users.", "C": "They make travel too expensive for ordinary people.", "D": "They cannot yet respond to a traveller's emotional state."}}, {"id": "r13", "q": "What concern do consumer groups raise?", "opts": {"A": "Users may not be aware of how much personal information they share.", "B": "Travel apps are making traditional tourism jobs disappear.", "C": "The technology is unreliable when booking international flights.", "D": "Apps recommend the same destinations to too many people."}}, {"id": "r14", "q": "The word 'outweighs' in the last paragraph means", "opts": {"A": "costs more than", "B": "is less important than", "C": "is more important than", "D": "is equal in value to"}}, {"id": "r15", "q": "What is the writer's overall conclusion about AI travel apps?", "opts": {"A": "They have already proven themselves superior to traditional methods.", "B": "It is still unclear whether they will improve or worsen travel overall.", "C": "They will soon replace all human roles in the tourism industry.", "D": "Their disadvantages make them unsuitable for most travellers."}}]},
    p4: {"inst": "Five sentences have been removed from the article. Choose from sentences A\u2013H the one which fits each gap. There are three extra sentences you do not need.", "title": "Growing Up Online", "sents": {"A": "This can make it difficult to distinguish between genuine friendships and superficial online connections.", "B": "As a result, many schools have begun offering dedicated lessons in digital literacy.", "C": "However, this freedom comes with responsibilities that young people are not always prepared for.", "D": "Experts suggest that open conversations at home are just as important as formal education.", "E": "Yet research suggests that the quality of these interactions varies considerably.", "F": "For this reason, some parents choose to delay giving their children smartphones until secondary school.", "G": "The platforms themselves have responded by introducing age verification tools.", "H": "This generation has grown up surrounded by technology in a way no previous generation has experienced."}, "parts": ["Today's teenagers are often called 'digital natives'. [GAP1] From an early age, they have communicated through screens, entertained themselves on demand and shared their lives publicly online.", "Social media gives young people a platform to express themselves and connect with others across the world. [GAP2] Posting personal information, interacting with strangers and managing a public image all require a level of judgement that develops gradually.", "One particular challenge is the nature of online friendships. Teenagers may have hundreds of followers or contacts. [GAP3] Studies show that many young people report feeling lonely despite being constantly connected.", "Parents and educators are increasingly aware of these issues. [GAP4] These classes cover topics such as recognising misinformation, protecting personal data and managing screen time effectively.", "Ultimately, technology itself is neither harmful nor beneficial \u2014 what matters is how it is used. [GAP5] Encouraging young people to reflect on their digital habits may be the most effective way to help them navigate an increasingly connected world."], "gapIds": ["r16", "r17", "r18", "r19", "r20"], "answers": {"r16": "H", "r17": "C", "r18": "A", "r19": "B", "r20": "D"}},
    p5: {"inst": "Read the text and choose the correct word for each space. Choose the correct letter A, B, C or D.", "title": "The Science of Sleep", "text": "Most teenagers need between eight and ten hours of sleep per night, yet surveys consistently show that the majority get (21)___ less than this. The reasons are well known: homework, social media, and the simple fact that adolescent body clocks are (22)___ to stay awake later than those of adults. (23)___ this biological tendency, schools in many countries still start early in the morning, meaning that students regularly arrive tired and (24)___ to concentrate. Scientists have been calling for later school start times for decades, and some districts have already (25)___ changes. The results have been encouraging \u2014 students report feeling better, and academic performance has shown measurable (26)___ in schools that have made the switch.", "qs": [{"id": "r21", "q": "(21)", "opts": {"A": "far", "B": "very", "C": "considerably", "D": "much"}}, {"id": "r22", "q": "(22)", "opts": {"A": "programmed", "B": "decided", "C": "chosen", "D": "set"}}, {"id": "r23", "q": "(23)", "opts": {"A": "Due to", "B": "Although", "C": "Despite", "D": "Because"}}, {"id": "r24", "q": "(24)", "opts": {"A": "impossible", "B": "unable", "C": "difficult", "D": "hard"}}, {"id": "r25", "q": "(25)", "opts": {"A": "done", "B": "taken", "C": "made", "D": "put"}}, {"id": "r26", "q": "(26)", "opts": {"A": "advances", "B": "rises", "C": "developments", "D": "improvements"}}]},
    p6: {"inst": "Read the text and write ONE word for each space.", "title": "Urban Farming", "text": "Growing food in cities is becoming increasingly popular around the world. Community gardens, rooftop farms and vertical growing systems are all part of a movement (27)___ is changing how urban residents think about food. Many city dwellers have never (28)___ involved in food production before, and discovering where their vegetables come from can be a genuinely eye-opening experience. Urban farms tend to use (29)___ water than traditional agriculture because they rely on efficient irrigation systems. They also help to reduce carbon emissions, (30)___ food does not need to travel long distances to reach consumers. There is (31)___ doubt that urban farming alone can feed an entire city, but it can make a meaningful contribution to food security. For many participants, the greatest benefit is (32)___ the fresh produce itself \u2014 it is the sense of community that grows alongside it.", "r27": "which", "r28": "been", "r29": "less", "r30": "as", "r31": "no", "r32": "not"},
    writing: {"p1inst": "You have received this email from your English-speaking friend, Jamie.", "p1email": "From: Jamie\nSubject: Staying healthy at school!\n\nHi! I've been trying to eat more healthily and get more exercise, but it's really hard with so much homework. How do you stay healthy during the school year? Do you think schools should do more to help students stay fit? What's your favourite way to relax after a long day?\n\nWrite back soon!\nJamie", "p1notes": ["How you stay healthy", "Whether schools should help more", "Your favourite way to relax"], "p1task": "Write an email to Jamie answering all three questions. Write about 100 words.", "p2a_title": "Technology in the Classroom", "p2a_prompt": "Your school magazine is asking students to write an article about technology in education. Write an article explaining how technology helps you learn, whether there are any disadvantages, and what you think schools should do. Write about 100 words.", "p2b_first": "The lights went out just as the exam was about to begin."}
  },
  B: {
    key: {"r1": "A", "r2": "C", "r3": "B", "r4": "A", "r5": "C", "r6": "F", "r7": "B", "r8": "H", "r9": "D", "r10": "A", "r11": "C", "r12": "A", "r13": "D", "r14": "B", "r15": "C", "r16": "C", "r17": "F", "r18": "A", "r19": "H", "r20": "E", "r21": "B", "r22": "D", "r23": "A", "r24": "C", "r25": "B", "r26": "D", "r27": "whose", "r28": "such", "r29": "even", "r30": "without", "r31": "having", "r32": "however"},
    p1: {"inst": "Look at the text in each question. What does it say? Choose the correct letter A, B or C.", "qs": [{"id": "r1", "sign": "SPORTS CENTRE\nAll lockers must be emptied by closing time.\nThe centre accepts no responsibility for items left overnight.", "q": "What does the notice say about lockers?", "opts": {"A": "Users must remove their belongings before the centre closes.", "B": "Lockers are available for overnight storage for a small fee.", "C": "The centre will contact you if anything is found in a locker."}}, {"id": "r2", "sign": "Text from Pablo:\nCan't make football tonight \u2014 knee is still sore.\nTell the coach? I'll be back Thursday for sure.", "q": "What does Pablo want his friend to do?", "opts": {"A": "Pick him up on Thursday evening.", "B": "Find a replacement player for tonight.", "C": "Let the coach know he will not be at training."}}, {"id": "r3", "sign": "SCHOOL CANTEEN\nHot meals served 12:00\u201313:30 only.\nSandwiches and snacks available all day.\nCard payments only \u2014 no cash accepted.", "q": "What should students know about the canteen?", "opts": {"A": "Hot food is available throughout the school day.", "B": "Students cannot pay with coins or notes.", "C": "Sandwiches must be ordered one hour in advance."}}, {"id": "r4", "sign": "Notice to residents:\nGarden waste collection will be suspended\nfor two weeks due to vehicle maintenance.\nPlease do not leave bags on the pavement.", "q": "What are residents asked to do?", "opts": {"A": "Keep their garden waste at home for the next two weeks.", "B": "Use a different collection point during the maintenance period.", "C": "Contact the council if they have large amounts of garden waste."}}, {"id": "r5", "sign": "READING GROUP \u2014 Monthly Meeting\nThis month's book: The Midnight Garden\nVenue changed to Room 14 (not the library)\nRefreshments provided", "q": "What has changed about the reading group meeting?", "opts": {"A": "The book that members need to read has been changed.", "B": "The meeting has been cancelled this month.", "C": "The group will meet in a different room than usual."}}]},
    p2: {"inst": "The people below are all looking for a weekend activity. Decide which activity (A\u2013H) would be most suitable for each person.", "people": [{"id": "r6", "name": "Andrea", "desc": "Andrea cares deeply about environmental issues and wants to spend her Saturday doing something practical to help the local area. She does not mind working outdoors in any weather."}, {"id": "r7", "name": "Carlos", "desc": "Carlos loves animals and spends a lot of time watching nature documentaries. He would like an activity where he can observe wildlife in its natural habitat."}, {"id": "r8", "name": "Isabela", "desc": "Isabela is a confident cook who enjoys experimenting with new recipes. She wants a sociable activity where she can share food with others and learn new techniques."}, {"id": "r9", "name": "Sergio", "desc": "Sergio is interested in science and technology. He wants a hands-on activity where he can build or make something and understand how it works."}, {"id": "r10", "name": "Camila", "desc": "Camila enjoys art and design. She is looking for a calm, creative activity she can do on her own at her own pace, without needing any previous experience."}], "acts": [{"l": "A", "title": "Watercolour for Beginners", "desc": "A relaxed three-hour session in a local studio. No experience required. All materials provided. Work at your own pace."}, {"l": "B", "title": "Birdwatching Walk", "desc": "A guided morning walk through the nature reserve with an expert ornithologist. Binoculars provided."}, {"l": "C", "title": "Robotics Workshop", "desc": "Build and programme a simple robot using provided kits. Suitable for ages 12 and above. No coding experience needed."}, {"l": "D", "title": "Electronics & Circuits Workshop", "desc": "Learn the basics of electronics by assembling working circuits. Explore how everyday devices are built from simple components."}, {"l": "E", "title": "Outdoor Yoga & Mindfulness", "desc": "A gentle morning session in the park. Suitable for complete beginners. Mats provided."}, {"l": "F", "title": "River Clean-up Volunteers", "desc": "Help remove litter from the riverbank with a local environmental group. Waterproof clothing recommended."}, {"l": "G", "title": "Street Photography Tour", "desc": "Explore the city with a photographer and learn composition techniques. Suitable for beginners."}, {"l": "H", "title": "Community Potluck Cooking Event", "desc": "Bring a dish to share and learn recipes from participants of different backgrounds. Informal and sociable atmosphere."}]},
    p3: {"inst": "Read the article and choose the correct answer A, B, C or D.", "title": "Why Young People Are Choosing to Volunteer", "text": "Volunteering was once seen primarily as something older retired people did with their spare time. That image is changing rapidly. Across the world, growing numbers of teenagers and young adults are choosing to dedicate part of their weekends and school holidays to unpaid community work \u2014 and researchers are trying to understand why.\n\nFor some, the motivation is straightforward: they want to help. A survey conducted last year found that sixty-two percent of young volunteers cited 'making a difference' as their primary reason for getting involved. But the picture is more complex than pure altruism. Many young people also acknowledge that volunteering looks good on university applications and future CVs, and that this plays a role in their decision.\n\nWhat surprises many adults is the range of skills that young volunteers develop. Organising food bank collections, supporting elderly residents or fundraising for local charities all require communication, time management and problem-solving \u2014 the same competencies that employers consistently say they look for in candidates.\n\nThere is also a social dimension. Several studies have found that volunteering reduces feelings of isolation, particularly among young people who struggle to connect with peers in traditional school settings. 'It gave me a sense of belonging I had never felt in the classroom,' said one seventeen-year-old who volunteers at a community garden.\n\nSchools and youth organisations increasingly recognise these benefits and are working to remove the main barrier to participation: time. By integrating volunteer opportunities into the school week rather than leaving them entirely to students' free time, educators hope to make community engagement accessible to all young people, not just those with flexible schedules.", "qs": [{"id": "r11", "q": "What does the survey mentioned in the article show?", "opts": {"A": "Most young volunteers are motivated entirely by career ambitions.", "B": "Retired people still make up the majority of volunteers worldwide.", "C": "The most common reason young people volunteer is to help others.", "D": "Fewer than half of young volunteers plan to continue after finishing school."}}, {"id": "r12", "q": "What do the skills developed through volunteering have in common with what employers want?", "opts": {"A": "They match the qualities that companies say they seek in job candidates.", "B": "They can only be developed through formal classroom education.", "C": "They are more relevant to university study than to employment.", "D": "They are difficult to demonstrate without a formal qualification."}}, {"id": "r13", "q": "According to the article, what social benefit does volunteering provide?", "opts": {"A": "It helps young people improve their academic performance at school.", "B": "It gives young people access to professional networks early in life.", "C": "It teaches young people how to manage conflict in group settings.", "D": "It can help young people feel more connected to a community."}}, {"id": "r14", "q": "What does the word 'barrier' mean in the final paragraph?", "opts": {"A": "an advantage", "B": "an obstacle", "C": "a rule", "D": "a requirement"}}, {"id": "r15", "q": "What solution do schools propose to encourage more volunteering?", "opts": {"A": "Offering financial rewards to students who complete volunteer hours.", "B": "Making volunteering a compulsory part of the school curriculum.", "C": "Including volunteer activities within the school timetable itself.", "D": "Partnering with universities to recognise volunteer experience officially."}}]},
    p4: {"inst": "Five sentences have been removed from the article. Choose from sentences A\u2013H the one which fits each gap. There are three extra sentences you do not need.", "title": "The Return of the Bicycle", "sents": {"A": "This has led many cyclists to seek quieter routes through residential streets instead.", "B": "In fact, the number of people cycling to work in major cities has doubled in some countries over the past decade.", "C": "Local councils have responded by investing in a new generation of protected cycle lanes.", "D": "Cycling was once considered a leisure activity for weekends and holidays, rarely taken seriously as a form of daily transport.", "E": "However, not everyone is happy about this transformation.", "F": "Many of these schemes allow users to pick up and drop off a bicycle at any point in the city.", "G": "This shift has not gone unnoticed by governments looking to reduce urban congestion and carbon emissions.", "H": "Electric bicycles have made cycling accessible to people who might previously have found it too physically demanding."}, "parts": ["[GAP1] That perception has shifted dramatically in recent years, as rising fuel costs, environmental awareness and improved cycling infrastructure have encouraged millions of people to swap four wheels for two.", "The growth in urban cycling has been remarkable. [GAP2] Bike-sharing schemes have also played an important role, making it possible to cycle without owning a bicycle.", "[GAP3] In city after city, planners are allocating road space previously reserved for cars to protected cycling corridors, separated from traffic by physical barriers.", "One significant development has been the rise of the e-bike. [GAP4] Commuters who live further from work, or who arrive at the office needing to look professional, can now cycle without arriving exhausted.", "[GAP5] Some drivers complain that cycle lanes reduce road capacity and create congestion. Residents in some areas have objected to the removal of parking spaces to make way for cycling infrastructure."], "gapIds": ["r16", "r17", "r18", "r19", "r20"], "answers": {"r16": "D", "r17": "F", "r18": "C", "r19": "H", "r20": "E"}},
    p5: {"inst": "Read the text and choose the correct word for each space.", "title": "Social Media and Self-Image", "text": "Research into the effects of social media on young people's mental health has produced mixed (21)___. Some studies suggest a clear link between heavy social media use and lower self-esteem, particularly among teenage girls. Others argue that the relationship is (22)___ complex \u2014 that social media can be both harmful and beneficial depending on how it is used. What most researchers (23)___ on is that comparison plays a central role. When people constantly (24)___ their own lives with the carefully edited highlights posted by others, they often come away feeling inadequate. The challenge for young users is learning to (25)___ these platforms critically, enjoying the genuine connections they offer while (26)___ the pressure to present a perfect version of themselves online.", "qs": [{"id": "r21", "q": "(21)", "opts": {"A": "answers", "B": "results", "C": "effects", "D": "data"}}, {"id": "r22", "q": "(22)", "opts": {"A": "very", "B": "quite", "C": "rather", "D": "more"}}, {"id": "r23", "q": "(23)", "opts": {"A": "agree", "B": "think", "C": "decide", "D": "conclude"}}, {"id": "r24", "q": "(24)", "opts": {"A": "match", "B": "put", "C": "compare", "D": "test"}}, {"id": "r25", "q": "(25)", "opts": {"A": "see", "B": "use", "C": "read", "D": "watch"}}, {"id": "r26", "q": "(26)", "opts": {"A": "ignoring", "B": "stopping", "C": "avoiding", "D": "resisting"}}]},
    p6: {"inst": "Read the text and write ONE word for each space.", "title": "The Ocean and Climate Change", "text": "The world's oceans cover more than seventy percent of the planet's surface, and their role in regulating the climate is one (27)___ scientists are studying with increasing urgency. The oceans absorb enormous quantities of heat and carbon dioxide \u2014 so (28)___ that without them, average global temperatures would be far higher than they are today. Warming seas are, (29)___ so, causing significant problems. Coral reefs, (30)___ which millions of marine species depend, are bleaching and dying as water temperatures rise. Many coastal communities are already experiencing more frequent flooding (31)___ to sea level rise. Scientists warn that the changes currently (32)___ place will take decades to reverse, even if carbon emissions are reduced dramatically.", "r27": "whose", "r28": "much", "r29": "even", "r30": "on", "r31": "due", "r32": "taking"},
    writing: {"p1inst": "You have received this email from your English-speaking friend, Sam.", "p1email": "From: Sam\nSubject: Planning our trip!\n\nHi! I'm so excited about our trip next month. I've been looking at things to do \u2014 should we focus more on outdoor activities or visiting museums and historical places? Also, what kind of food should we try? And is there anything I should pack that I might not think of?\n\nCan't wait!\nSam", "p1notes": ["Outdoor activities vs museums", "Food to try", "What to pack"], "p1task": "Write an email to Sam answering all three questions. Write about 100 words.", "p2a_title": "The Environment and Young People", "p2a_prompt": "Your school magazine wants articles on this question: 'What can young people do to help the environment?' Write an article giving your opinion and practical suggestions. Write about 100 words.", "p2b_first": "Nobody expected to find a tiger in the school car park."}
  },
  C: {
    key: {"r1": "C", "r2": "A", "r3": "B", "r4": "C", "r5": "A", "r6": "G", "r7": "C", "r8": "A", "r9": "E", "r10": "D", "r11": "A", "r12": "C", "r13": "B", "r14": "D", "r15": "A", "r16": "E", "r17": "B", "r18": "G", "r19": "C", "r20": "F", "r21": "D", "r22": "B", "r23": "C", "r24": "A", "r25": "D", "r26": "B", "r27": "although", "r28": "by", "r29": "what", "r30": "made", "r31": "when", "r32": "despite"},
    p1: {"inst": "Look at the text in each question. What does it say? Choose the correct letter A, B or C.", "qs": [{"id": "r1", "sign": "GYM NOTICE\nAll equipment must be wiped down after use.\nPlease report any faults to reception immediately.\nDo not attempt to repair machines yourself.", "q": "What are gym users told to do?", "opts": {"A": "Book equipment in advance to avoid waiting.", "B": "Ask a trainer before using any equipment.", "C": "Clean machines after they finish using them."}}, {"id": "r2", "sign": "From: Coach Rivera\nTo: Swimming team\nTraining moved to 6am Thursday due to pool maintenance.\nConfirm attendance by Wednesday 5pm.", "q": "What must swimmers do by Wednesday?", "opts": {"A": "Let the coach know if they will attend Thursday's session.", "B": "Arrive at the pool before 6am on Thursday.", "C": "Collect a new training schedule from reception."}}, {"id": "r3", "sign": "MARKET SQUARE\nFarmers' Market every Saturday 8am\u20131pm\nNo market on public holidays\nCard and cash both accepted", "q": "What information is given about the farmers' market?", "opts": {"A": "It operates on Saturdays and Sundays throughout the year.", "B": "It does not take place on certain days of the year.", "C": "Shoppers must pay with cash only at this market."}}, {"id": "r4", "sign": "Attention Year 10 students:\nThe careers fair has been extended to include Friday afternoon.\nNew session: 2pm\u20135pm, Main Hall.\nAttendance is optional.", "q": "What does the notice tell students?", "opts": {"A": "The careers fair has been moved to Friday only.", "B": "All Year 10 students must attend the careers fair.", "C": "There is now an additional session for the careers fair on Friday."}}, {"id": "r5", "sign": "Note from Dad:\nPicked up your prescription \u2014 it's on the kitchen counter.\nRemember to take with food. Doctor said twice daily.\nI'll be back at 7.", "q": "What does Dad want his child to know?", "opts": {"A": "The medicine has been collected and instructions for taking it.", "B": "They need to go to the pharmacy before dinner.", "C": "The doctor wants to see them again in two days."}}]},
    p2: {"inst": "The people below are all looking for a weekend activity. Decide which activity (A\u2013H) would be most suitable for each person.", "people": [{"id": "r6", "name": "Tom\u00e1s", "desc": "Tom\u00e1s is very sporty and enjoys competitive activities. He wants something fast-paced where he can push himself physically and compete against other participants."}, {"id": "r7", "name": "Pilar", "desc": "Pilar is interested in science and how things work. She enjoys hands-on activities and would like to make or build something she can take home at the end."}, {"id": "r8", "name": "Renata", "desc": "Renata loves drawing and painting. She wants a relaxed, creative session where she can work independently and develop her skills with professional guidance."}, {"id": "r9", "name": "Esteban", "desc": "Esteban is passionate about music. He plays guitar and would like an activity where he can play with others, learn new styles and enjoy a sociable atmosphere."}, {"id": "r10", "name": "Daniela", "desc": "Daniela wants to do something useful for the community. She would like to work with children or elderly people and make a direct positive difference to someone's day."}], "acts": [{"l": "A", "title": "Life Drawing Class", "desc": "A three-hour session with a professional artist. Work from a live model and develop observational drawing skills. All levels welcome."}, {"l": "B", "title": "Community Garden Project", "desc": "Join local residents to plant and maintain a shared vegetable garden. Physical work outdoors. All tools provided."}, {"l": "C", "title": "Electronics for Beginners", "desc": "Build a working electronic gadget to take home. Step-by-step guidance from an engineer. Suitable for ages 13 and above."}, {"l": "D", "title": "Befriending Scheme", "desc": "Spend a few hours with elderly residents at a local care home. Activities include reading, games and conversation. Full training provided."}, {"l": "E", "title": "Open Mic & Jam Session", "desc": "A relaxed afternoon of live music. Bring your instrument and play with other musicians of all styles and abilities."}, {"l": "F", "title": "Mindfulness & Journalling Workshop", "desc": "A calm indoor session exploring creative writing and relaxation techniques. No writing experience needed."}, {"l": "G", "title": "5-a-side Football Tournament", "desc": "Competitive matches for players of all abilities. Teams of five. Fast-paced and fun. Open to ages 13\u201318."}, {"l": "H", "title": "Jewellery Making Workshop", "desc": "Learn to create silver jewellery pieces using basic metalworking tools. Take home what you make."}]},
    p3: {"inst": "Read the article and choose the correct answer A, B, C or D.", "title": "The Surprising Benefits of Boredom", "text": "In a world of constant notifications, streaming services and instant entertainment, boredom has become something most people actively avoid. Yet a growing body of scientific research suggests that moments of doing nothing may be more valuable than we think.\n\nPsychologists define boredom as the unpleasant experience of wanting to engage in something satisfying but being unable to do so. For decades it was viewed negatively \u2014 a state to be avoided or quickly resolved. Recent studies, however, have produced unexpected findings. When people allow themselves to be bored without immediately reaching for their phone, the brain enters a mode of relaxed, undirected thought known as the 'default network'. This state is associated with creativity, self-reflection and problem-solving.\n\nResearchers at the University of Central Lancashire found that participants who completed a boring task before a creative challenge performed significantly better than those who went straight to the creative task. The theory is that boredom encourages the mind to seek stimulation, which in turn activates imaginative thinking.\n\nChildren may stand to benefit most from this finding. Many child development experts argue that unstructured, screen-free time is essential for developing imagination and independent thinking. When children are constantly occupied \u2014 by organised activities, digital devices or adult supervision \u2014 they miss the mental space that boredom provides.\n\nOf course, chronic boredom \u2014 the persistent sense of meaninglessness \u2014 is linked to negative outcomes including depression and risk-taking behaviour. The key, researchers suggest, is distinguishing between productive boredom, which can spark creativity, and the kind of deep, prolonged boredom that signals a deeper problem. Used wisely, a moment of doing nothing might be the most productive thing you do all day.", "qs": [{"id": "r11", "q": "What did recent research find about boredom?", "opts": {"A": "It can have positive effects when people do not immediately seek distraction.", "B": "It is mainly harmful to adults but beneficial for children.", "C": "It reduces creativity because the brain becomes less active.", "D": "It is experienced in the same way by all people regardless of age."}}, {"id": "r12", "q": "What did the University of Central Lancashire study show?", "opts": {"A": "Boring tasks should be avoided before any kind of work.", "B": "Creative tasks are more enjoyable when completed first.", "C": "Doing something boring first can improve creative performance.", "D": "Most people find it impossible to complete boring tasks without distraction."}}, {"id": "r13", "q": "According to child development experts, what do children need?", "opts": {"A": "More structured activities to develop discipline and focus.", "B": "Time that is not filled with organised activities or screens.", "C": "Regular adult supervision to guide their imaginative play.", "D": "Digital tools that promote creativity rather than passive consumption."}}, {"id": "r14", "q": "What is the difference between productive boredom and chronic boredom?", "opts": {"A": "Productive boredom lasts longer and is more intense than chronic boredom.", "B": "Chronic boredom is always caused by too much screen time.", "C": "Productive boredom occurs in children while chronic boredom affects adults.", "D": "Productive boredom can inspire creativity while chronic boredom is harmful."}}, {"id": "r15", "q": "What is the writer's main message in this article?", "opts": {"A": "Allowing yourself to be bored occasionally may have real benefits.", "B": "Boredom is a serious problem that society needs to address urgently.", "C": "Technology is the main cause of boredom in modern life.", "D": "Children are better at managing boredom than adults."}}]},
    p4: {"inst": "Five sentences have been removed from the article. Choose from sentences A\u2013H the one which fits each gap. There are three extra sentences you do not need.", "title": "The World's Fastest-Growing Sport", "sents": {"A": "It requires almost no equipment \u2014 just a ball and a flat surface \u2014 making it accessible to people with very little money.", "B": "Professional players can earn more in a single match than most people make in a year.", "C": "The sport's governing body has also introduced a global ranking system to bring greater structure to international competition.", "D": "Local communities have been quick to recognise its potential as a tool for social inclusion.", "E": "Padel is a racket sport that combines elements of tennis and squash, played on an enclosed court smaller than a tennis court.", "F": "This simplicity is one reason the sport has spread so quickly across continents with very different economic conditions.", "G": "In some countries, demand for courts has outpaced the ability of clubs and municipalities to build them.", "H": "Fans of the sport argue that it is also less physically demanding than tennis, making it ideal for older players."}, "parts": ["If you have not yet heard of padel, you soon will. [GAP1] What began as a niche sport in Mexico in the 1960s has grown into a global phenomenon, with an estimated 25 million players across more than 90 countries.", "Part of padel's appeal is its simplicity. Unlike tennis, it can be learned quickly, and most beginners feel comfortable on a court within their first session. [GAP2] This makes padel one of the most socially diverse sports in the world, attracting players from very different backgrounds.", "The sport's rise has created both opportunities and challenges for infrastructure. Courts are expensive to build, and in many European cities the waiting list for club membership is months long. [GAP3] Some cities have responded by converting unused car parks and urban spaces into temporary padel facilities.", "[GAP4] Charities and schools in several countries have begun using padel as a way to engage young people who have dropped out of more traditional sports, finding that the sport's sociable, doubles-based format encourages teamwork and communication.", "Internationally, padel is now a professional sport with its own dedicated tour and significant sponsorship deals. [GAP5] Whether it will one day rival tennis in global popularity remains to be seen, but few sports have grown so quickly in such a short time."], "gapIds": ["r16", "r17", "r18", "r19", "r20"], "answers": {"r16": "E", "r17": "A", "r18": "G", "r19": "D", "r20": "C"}},
    p5: {"inst": "Read the text and choose the correct word for each space.", "title": "Music and the Mind", "text": "Scientists have long known that music has a powerful (21)___ on the human brain. Listening to a favourite song can change a person's mood within seconds, while learning to play an instrument has been shown to (22)___ memory, concentration and even mathematical ability. What is perhaps less well known is that different types of music affect the brain in (23)___ ways. Fast, upbeat music tends to increase alertness and energy, which is why it is often (24)___ in gyms and during exercise. Slower, more complex music, on the other hand, can (25)___ the listener to focus, making it popular among students studying for exams. Researchers are now exploring whether music could be used more widely in (26)___ settings \u2014 for example, to reduce anxiety before medical procedures.", "qs": [{"id": "r21", "q": "(21)", "opts": {"A": "pressure", "B": "force", "C": "impact", "D": "effect"}}, {"id": "r22", "q": "(22)", "opts": {"A": "rise", "B": "improve", "C": "develop", "D": "increase"}}, {"id": "r23", "q": "(23)", "opts": {"A": "similar", "B": "some", "C": "different", "D": "various"}}, {"id": "r24", "q": "(24)", "opts": {"A": "played", "B": "heard", "C": "put", "D": "done"}}, {"id": "r25", "q": "(25)", "opts": {"A": "make", "B": "force", "C": "push", "D": "help"}}, {"id": "r26", "q": "(26)", "opts": {"A": "educational", "B": "medical", "C": "professional", "D": "scientific"}}]},
    p6: {"inst": "Read the text and write ONE word for each space.", "title": "Food Waste", "text": "Every year, roughly one third of all food produced globally is wasted \u2014 a statistic that is deeply troubling (27)___ you consider that hundreds of millions of people go hungry every day. Food is wasted at every stage of production, from crops left unharvested in fields to meals thrown away (28)___ restaurants and households. In many high-income countries, consumers throw away food simply because it has passed its best-before date, regardless of (29)___ it is actually still safe to eat. Campaigns to reduce food waste have (30)___ some progress in recent years \u2014 supermarkets have introduced ugly vegetable ranges, and apps now connect restaurants with customers who want discounted meals at closing time. But (31)___ it comes to changing habits at home, progress has been slower. Experts say that reducing food waste (32)___ the strong consumer awareness campaigns remains a significant challenge.", "r27": "when", "r28": "by", "r29": "whether", "r30": "made", "r31": "when", "r32": "without"},
    writing: {"p1inst": "You have received this email from your English-speaking friend, Alex.", "p1email": "From: Alex\nSubject: School project \u2014 need your help!\n\nHi! I'm doing a project about young people and sport. Do you do any sport regularly? Do you think it's important for schools to make sport compulsory? And what do you think is the best way to encourage teenagers who don't like sport to get more active?\n\nThanks!\nAlex", "p1notes": ["Sport you do regularly", "Whether sport should be compulsory", "How to encourage inactive teenagers"], "p1task": "Write an email to Alex answering all three questions. Write about 100 words.", "p2a_title": "Food from Around the World", "p2a_prompt": "Your school magazine is writing about food and culture. Write an article about a dish from your country or culture that you would recommend to people from other countries. Describe the dish, explain how it is made and say why you think others would enjoy it. Write about 100 words.", "p2b_first": "I opened the old box and could not believe what was inside."}
  },
  D: {
    key: {"r1": "B", "r2": "A", "r3": "C", "r4": "B", "r5": "A", "r6": "C", "r7": "F", "r8": "A", "r9": "H", "r10": "D", "r11": "D", "r12": "B", "r13": "A", "r14": "C", "r15": "B", "r16": "F", "r17": "B", "r18": "D", "r19": "G", "r20": "A", "r21": "C", "r22": "A", "r23": "D", "r24": "B", "r25": "A", "r26": "C", "r27": "that", "r28": "up", "r29": "own", "r30": "out", "r31": "being", "r32": "so"},
    p1: {"inst": "Look at the text in each question. What does it say? Choose the correct letter A, B or C.", "qs": [{"id": "r1", "sign": "MUSIC ROOM\nAvailable for individual practice Mon\u2013Fri 3:30\u20135:30pm\nBookings essential \u2014 sign up at reception\nMaximum 1 hour per student per day", "q": "What must students do to use the music room?", "opts": {"A": "Arrive before 3:30pm to guarantee a space.", "B": "Reserve a time slot at reception before using it.", "C": "Bring their own instrument and sign in at the door."}}, {"id": "r2", "sign": "Note for delivery:\nPlease leave all packages at the side entrance.\nDo not ring the bell \u2014 baby sleeping.\nThank you!", "q": "What does the note ask the delivery person to do?", "opts": {"A": "Leave parcels at the side entrance without ringing the bell.", "B": "Ring the bell once and wait at the side entrance.", "C": "Come back later when the baby is awake."}}, {"id": "r3", "sign": "TOWN HALL EXHIBITION\nLocal Artists Showcase \u2014 free entry\nOpen daily 10am\u20136pm except Mondays\nNo photography inside the gallery", "q": "What rule applies inside the exhibition?", "opts": {"A": "Visitors must pay an entrance fee on weekdays.", "B": "The exhibition is only open at weekends.", "C": "Taking photos in the gallery is not allowed."}}, {"id": "r4", "sign": "Message from Leo:\nFound your jacket at the sports hall \u2014 it was on the bench near court 3.\nI've left it at lost property. Pick it up before Friday!", "q": "What does Leo want the reader to know?", "opts": {"A": "He took the jacket home to keep it safe until Friday.", "B": "The jacket has been handed in at the lost property office.", "C": "He found the jacket on Friday near the sports hall entrance."}}, {"id": "r5", "sign": "CINEMA \u2014 STAFF NOTICE\nAll staff must clock in using the new digital system from Monday.\nPaper timesheets will no longer be accepted.\nSee manager for login details.", "q": "What change is being introduced for staff?", "opts": {"A": "They must record their working hours using a new computer system.", "B": "They need to collect paper timesheets from the manager each week.", "C": "They should arrive earlier on Mondays to set up the new system."}}]},
    p2: {"inst": "The people below are all looking for a weekend activity. Decide which activity (A\u2013H) would be most suitable for each person.", "people": [{"id": "r6", "name": "Marco", "desc": "Marco wants to improve his fitness but prefers non-competitive activities. He would like something calm and focused that he can do at his own pace, ideally outdoors."}, {"id": "r7", "name": "Elena", "desc": "Elena is creative and loves working with her hands. She wants to learn a traditional craft she can practise at home and give as gifts to friends and family."}, {"id": "r8", "name": "Felipe", "desc": "Felipe is sociable and enjoys meeting new people. He would like an activity with a strong community atmosphere where he can chat and have fun at the same time."}, {"id": "r9", "name": "Sara", "desc": "Sara is interested in history and culture. She would like to spend her Saturday learning about the local area and its past in an engaging, informal way."}, {"id": "r10", "name": "Diego", "desc": "Diego loves being in nature and wants a quiet activity where he can observe the natural world. He prefers activities that do not require expensive equipment."}], "acts": [{"l": "A", "title": "Community Board Game Caf\u00e9", "desc": "Join local residents for an afternoon of board games, puzzles and conversation. No booking required. Refreshments available."}, {"l": "B", "title": "Tai Chi in the Park", "desc": "A gentle morning session for all levels. Focus on breathing, balance and relaxation. Suitable for beginners. Free entry."}, {"l": "C", "title": "Outdoor Yoga Flow", "desc": "A one-hour session in the botanical gardens focusing on strength, flexibility and mindfulness. Bring your own mat."}, {"l": "D", "title": "Forest Bathing Walk", "desc": "A slow, silent walk through woodland led by a certified guide. No equipment needed. Focus on observing trees, birds and plants."}, {"l": "E", "title": "Street Art Tour", "desc": "A walking tour of local murals and public art installations with an artist guide. Suitable for all ages."}, {"l": "F", "title": "Traditional Pottery Class", "desc": "Learn to throw and shape clay on a wheel. Take home your finished piece after glazing. All materials provided."}, {"l": "G", "title": "Historical Walking Tour", "desc": "Explore the hidden history of the city with a local historian. Two hours, ending at the old market square."}, {"l": "H", "title": "Astronomy Night", "desc": "Observe stars and planets through telescopes at the local observatory. Expert guides explain what you can see."}]},
    p3: {"inst": "Read the article and choose the correct answer A, B, C or D.", "title": "Libraries Are Changing \u2014 But Not Disappearing", "text": "For years, commentators have predicted the death of the public library. As bookshops struggled and physical book sales fell, many assumed libraries would follow. Instead, something unexpected has happened: libraries have reinvented themselves, and in many cities they are more popular than ever.\n\nThe modern public library is far more than a place to borrow books. Many now offer recording studios, 3D printers, language exchange programmes, job application workshops, and spaces for community meetings. In some cities, libraries lend unusual items such as tools, musical instruments and even suits for job interviews. The underlying principle \u2014 giving people access to things they cannot easily afford themselves \u2014 remains the same, but what libraries actually offer has expanded dramatically.\n\nThis transformation has not been without controversy. Some librarians and regular visitors feel that the focus on technology and community services has come at the cost of the library's core identity as a quiet place for reading and reflection. 'When I come in to read, I sometimes feel like I've walked into a caf\u00e9 or a classroom,' said one frequent visitor.\n\nFunding remains a significant challenge. In many countries, library budgets have been cut repeatedly over the past decade, forcing staff reductions and shorter opening hours. Campaigners argue that libraries serve communities that other institutions do not reach \u2014 unemployed people, elderly residents, children from low-income households \u2014 and that cutting their funding has real human consequences.\n\nDespite these pressures, the library as an institution shows no sign of vanishing. If anything, the pandemic demonstrated how much communities value having a local space that belongs to everyone.", "qs": [{"id": "r11", "q": "What has surprised commentators about public libraries?", "opts": {"A": "Physical book sales have continued to fall despite library efforts.", "B": "Libraries have become less popular as bookshops have struggled.", "C": "Many libraries have had to close due to falling visitor numbers.", "D": "Libraries have adapted and in many places become more popular."}}, {"id": "r12", "q": "According to the article, what do modern libraries have in common with traditional ones?", "opts": {"A": "They focus primarily on providing books and reading materials.", "B": "They give people access to things they might not otherwise afford.", "C": "They operate in the same quiet, reflective environment as before.", "D": "They rely on the same level of government funding as in the past."}}, {"id": "r13", "q": "What criticism do some visitors make of modern libraries?", "opts": {"A": "They feel the library has lost its character as a calm, reading-focused space.", "B": "They believe libraries spend too much money on technology.", "C": "They think libraries should focus on lending more unusual items.", "D": "They argue that staff are less helpful than they used to be."}}, {"id": "r14", "q": "The word 'campaigners' in paragraph four refers to people who", "opts": {"A": "work as librarians in underfunded libraries.", "B": "write articles about the importance of reading.", "C": "argue publicly in support of library funding.", "D": "use libraries regularly and want longer opening hours."}}, {"id": "r15", "q": "What does the writer suggest about libraries at the end of the article?", "opts": {"A": "They will need to change even more dramatically in the next decade.", "B": "Communities showed how much they valued them during the pandemic.", "C": "The pandemic proved that online libraries are a better alternative.", "D": "They are likely to disappear unless funding problems are resolved."}}]},
    p4: {"inst": "Five sentences have been removed from the article. Choose from sentences A\u2013H the one which fits each gap. There are three extra sentences you do not need.", "title": "The City That Went Car-Free", "sents": {"A": "Within a year of the change, air pollution in the area had dropped by nearly forty percent.", "B": "The decision was controversial from the start, with local businesses fearing a dramatic loss of customers.", "C": "Several European capitals have since studied the model with a view to implementing similar schemes.", "D": "City authorities responded by introducing free public transport on days when pollution levels were particularly high.", "E": "The city also invested heavily in cycling infrastructure, adding over fifty kilometres of protected cycle lanes.", "F": "Surveys showed that the majority of residents supported the change once they experienced it firsthand.", "G": "In fact, many shops reported higher sales, as pedestrian footfall increased significantly.", "H": "The experiment began modestly, with just one street in the historic centre being closed to vehicles on Sundays."}, "parts": ["When the mayor of a medium-sized European city announced plans to remove private cars from the city centre permanently, few people believed it would actually happen. [GAP1] Local taxi drivers organised protests, and a petition against the plans gathered thousands of signatures within days.", "[GAP2] Residents discovered that walking or cycling through a street without traffic was a genuinely pleasant experience, and caf\u00e9s and restaurants that had previously been invisible behind parked cars suddenly became destinations in their own right.", "The fears of business owners proved largely unfounded. [GAP3] The removal of parking spaces was more than compensated by the arrival of pedestrians who lingered longer and spent more freely.", "Environmental improvements followed quickly. [GAP4] Residents reported sleeping better, and the number of children cycling to school tripled in three years.", "The success of the scheme attracted international attention. [GAP5] For city planners around the world, it offered a compelling example of what urban spaces could look like when designed around people rather than vehicles."], "gapIds": ["r16", "r17", "r18", "r19", "r20"], "answers": {"r16": "B", "r17": "F", "r18": "G", "r19": "A", "r20": "C"}},
    p5: {"inst": "Read the text and choose the correct word for each space.", "title": "How Animals Navigate", "text": "Many animals possess navigational abilities that continue to (21)___ scientists. Migratory birds, for example, can travel thousands of kilometres and return to exactly the same nesting site year after year. Researchers have discovered that some species use the Earth's magnetic field as a kind of internal compass, (22)___ them to detect direction even in complete darkness. Sea turtles are (23)___ remarkable \u2014 they return to the very beach where they were born to lay their own eggs, sometimes after spending decades at sea. Honeybees communicate the precise (24)___ of food sources to other bees through a complex series of movements known as the waggle dance. Scientists believe that understanding these natural navigation systems could (25)___ new technologies for human use \u2014 particularly in situations where GPS signals are (26)___ or unavailable.", "qs": [{"id": "r21", "q": "(21)", "opts": {"A": "puzzle", "B": "interest", "C": "amaze", "D": "confuse"}}, {"id": "r22", "q": "(22)", "opts": {"A": "helping", "B": "making", "C": "allowing", "D": "letting"}}, {"id": "r23", "q": "(23)", "opts": {"A": "even", "B": "too", "C": "very", "D": "equally"}}, {"id": "r24", "q": "(24)", "opts": {"A": "place", "B": "location", "C": "spot", "D": "area"}}, {"id": "r25", "q": "(25)", "opts": {"A": "inspire", "B": "create", "C": "build", "D": "produce"}}, {"id": "r26", "q": "(26)", "opts": {"A": "missing", "B": "broken", "C": "lost", "D": "weak"}}]},
    p6: {"inst": "Read the text and write ONE word for each space.", "title": "The Tiny House Movement", "text": "Across the world, a growing number of people are choosing to live in homes (27)___ are considerably smaller than the average \u2014 sometimes no bigger than a single room. The tiny house movement, as it has become known, began in the United States but has spread to countries as far (28)___ as Australia and Japan. Supporters argue that living with less forces people to reconsider what they truly (29)___ need, leading to simpler, less stressful lives. Smaller homes also cost less to heat, are cheaper to maintain and leave a smaller environmental footprint. Critics point (30)___ that tiny homes are not practical for families with children, and that the lifestyle appeals mainly to single people or couples (31)___ able to work remotely. Nevertheless, as housing costs continue to rise in many cities, what once seemed like an unusual lifestyle choice is (32)___ attracting more mainstream attention.", "r27": "that", "r28": "afield", "r29": "own", "r30": "out", "r31": "being", "r32": "now"},
    writing: {"p1inst": "You have received this email from your English-speaking friend, Jordan.", "p1email": "From: Jordan\nSubject: Moving to a new city!\n\nHi! I just found out my family is moving to a new city next month and I'm really nervous. How did you feel when you had to adapt to something new? What advice would you give me about making friends quickly? And do you think it's better to focus on school or on social life when you first arrive somewhere?\n\nThanks!\nJordan", "p1notes": ["How you felt adapting to something new", "Advice for making friends quickly", "School vs social life when arriving somewhere new"], "p1task": "Write an email to Jordan answering all three questions. Write about 100 words.", "p2a_title": "The Perfect City", "p2a_prompt": "Your school magazine is asking students: 'What would the perfect city look like?' Write an article describing your ideal city \u2014 what facilities it would have, how people would get around, and what would make it a great place to live. Write about 100 words.", "p2b_first": "She had walked past the old library a thousand times, but she had never noticed the door hidden behind the ivy."}
  },
  E: {
    key: {"r1": "A", "r2": "C", "r3": "B", "r4": "A", "r5": "C", "r6": "D", "r7": "G", "r8": "B", "r9": "E", "r10": "H", "r11": "B", "r12": "C", "r13": "D", "r14": "A", "r15": "C", "r16": "C", "r17": "E", "r18": "A", "r19": "H", "r20": "D", "r21": "B", "r22": "D", "r23": "A", "r24": "C", "r25": "B", "r26": "D", "r27": "while", "r28": "enough", "r29": "both", "r30": "used", "r31": "once", "r32": "yet"},
    p1: {"inst": "Look at the text in each question. What does it say? Choose the correct letter A, B or C.", "qs": [{"id": "r1", "sign": "SCHOOL CANTEEN\nHot lunches must be pre-ordered by 9am each day.\nWalk-in orders cannot be guaranteed.\nPayment online only \u2014 no cash at the till.", "q": "What do students need to know about hot lunches?", "opts": {"A": "They must order their lunch online before 9am if they want to be sure of getting one.", "B": "Students can order at the till but must pay with a card rather than cash.", "C": "Hot lunches are only available to students who have pre-paid for the week."}}, {"id": "r2", "sign": "Message from Rosa:\nI left my biology notes on your desk by accident \u2014 can you photograph them and send them over? Need them for revision tonight. Thanks!", "q": "What does Rosa want her friend to do?", "opts": {"A": "Bring the notes to school tomorrow morning.", "B": "Lend her the notes until after the biology exam.", "C": "Take a picture of the notes and send them to her."}}, {"id": "r3", "sign": "ADVENTURE PARK\nAll participants under 16 must be accompanied by an adult.\nSafety briefing compulsory before first activity.\nNo refunds for unused activities.", "q": "What rule applies to younger visitors?", "opts": {"A": "They must complete all activities to receive a refund.", "B": "They need an adult with them at all times in the park.", "C": "They must book a safety briefing at least one day in advance."}}, {"id": "r4", "sign": "OFFICE NOTICE\nThe lift is out of service until further notice.\nPlease use the stairs or wait for the engineer.\nWe apologise for the inconvenience.", "q": "What are people in the building told?", "opts": {"A": "The lift is currently not working and stairs should be used instead.", "B": "An engineer will fix the lift by the end of the day.", "C": "The stairs are also closed while the lift is being repaired."}}, {"id": "r5", "sign": "From: Head of Year\nTo: Year 9 parents\nThe parents' evening originally planned for Thursday has been rescheduled to the following Tuesday.\nPlease update your calendars accordingly.", "q": "What has happened to the parents' evening?", "opts": {"A": "It has been cancelled and will not take place this term.", "B": "It has been moved to a different week of the month.", "C": "It will now take place on a different day than originally planned."}}]},
    p2: {"inst": "The people below are all looking for a weekend activity. Decide which activity (A\u2013H) would be most suitable for each person.", "people": [{"id": "r6", "name": "Lucia", "desc": "Lucia wants to do something that will help her future career. She is thinking about studying law or journalism and would like an activity that develops public speaking or writing skills."}, {"id": "r7", "name": "Andr\u00e9s", "desc": "Andr\u00e9s is very physically active and loves a challenge. He wants something extreme and exciting that will push his limits \u2014 he is not afraid of heights or speed."}, {"id": "r8", "name": "Carmen", "desc": "Carmen loves animals and spends a lot of time at the local animal shelter. She would like a relaxed activity that involves caring for animals and being outdoors."}, {"id": "r9", "name": "Nicol\u00e1s", "desc": "Nicol\u00e1s enjoys cooking and wants to expand his skills. He would like a practical activity where he can learn from a professional chef and eat the results."}, {"id": "r10", "name": "Julia", "desc": "Julia is interested in science and the natural world. She wants an educational activity where she can learn about local ecosystems and wildlife in their natural habitat."}], "acts": [{"l": "A", "title": "Debate Club Open Day", "desc": "Practice structured argumentation and public speaking on current issues. Suitable for ages 13 and above. No experience needed."}, {"l": "B", "title": "Horse Riding for Beginners", "desc": "A gentle introduction to horse riding in a supervised environment. Suitable for complete beginners. Helmets provided."}, {"l": "C", "title": "Creative Writing Workshop", "desc": "Develop storytelling skills with a published author. Focus on character, dialogue and structure. All genres welcome."}, {"l": "D", "title": "Mock Trial Experience", "desc": "Take on the role of lawyer, witness or juror in a realistic courtroom simulation. Develop speaking, reasoning and teamwork skills."}, {"l": "E", "title": "Street Food Masterclass", "desc": "Learn to cook three dishes from different world cuisines with a professional chef. Eat what you make. All ingredients provided."}, {"l": "F", "title": "Rock Climbing Centre", "desc": "Indoor climbing walls for all levels. Beginners welcome. Qualified instructors on site. Safety equipment provided."}, {"l": "G", "title": "Zip Line & High Ropes Course", "desc": "Navigate a series of aerial obstacles and zip lines above the treetops. Minimum age 12. Full safety briefing included."}, {"l": "H", "title": "Guided Nature Reserve Walk", "desc": "A three-hour guided walk through a protected wetland habitat. Learn about local birds, plants and conservation efforts."}]},
    p3: {"inst": "Read the article and choose the correct answer A, B, C or D.", "title": "The Rise of the Teenage Entrepreneur", "text": "Starting a business used to be something people did in their thirties or forties, armed with years of experience and \u2014 hopefully \u2014 some savings. That picture is changing. A growing number of teenagers are launching their own small businesses, and some are achieving remarkable success before they finish secondary school.\n\nThe internet has played a decisive role in making this possible. Social media platforms allow young people to reach potential customers at virtually no cost, while digital tools make it straightforward to build a simple website, process payments and manage orders without specialist knowledge. What once required an office, staff and significant investment can now be done from a bedroom.\n\nThe types of businesses vary enormously. Some teenagers sell handmade jewellery or clothing. Others offer tutoring services to younger students, deliver social media management to local businesses, or create digital content for online audiences. What many share is a willingness to identify a gap and move quickly to fill it.\n\nNot all teenage businesses succeed, of course, and educators have mixed views on the trend. Some teachers welcome the entrepreneurial spirit and the practical skills it develops \u2014 financial management, marketing, customer communication. Others worry that it can distract young people from their studies at a critical time.\n\nFor those who do find success, the experience is often transformative regardless of whether the business eventually closes. 'Even if it doesn't work out, you learn things about yourself that no classroom can teach you,' said one seventeen-year-old who ran a successful custom clothing business for two years before returning her full attention to her studies.", "qs": [{"id": "r11", "q": "According to the article, what has made it easier for teenagers to start businesses?", "opts": {"A": "Government schemes that provide young entrepreneurs with funding.", "B": "Digital technology that removes many of the traditional barriers to starting a business.", "C": "Schools that now teach business skills as part of the curriculum.", "D": "The decline of traditional businesses, which has created more opportunities."}}, {"id": "r12", "q": "What do many successful teenage businesses have in common, according to the article?", "opts": {"A": "They all use social media to sell their products directly.", "B": "They are usually started with help from a parent or relative.", "C": "They spot an unmet need and act on it quickly.", "D": "They focus on products rather than services."}}, {"id": "r13", "q": "What concern do some teachers have about teenage entrepreneurs?", "opts": {"A": "They worry that young people are taking on too much financial risk.", "B": "They believe most teenage businesses are unlikely to succeed.", "C": "They think young entrepreneurs rely too heavily on social media.", "D": "They fear the business activity may interfere with students' education."}}, {"id": "r14", "q": "The word 'transformative' in the final paragraph means", "opts": {"A": "having a powerful effect that changes someone significantly.", "B": "leading to unexpected financial success.", "C": "producing results that last for a long time.", "D": "making a person more confident in social situations."}}, {"id": "r15", "q": "What is the main point the seventeen-year-old makes at the end of the article?", "opts": {"A": "Running a business is more educational than attending school.", "B": "It is important to close a business before it affects your exam results.", "C": "Running a business teaches valuable lessons even if it does not last.", "D": "Young people should wait until they finish school before starting a business."}}]},
    p4: {"inst": "Five sentences have been removed from the article. Choose from sentences A\u2013H the one which fits each gap. There are three extra sentences you do not need.", "title": "Why We Dream", "sents": {"A": "This theory is supported by studies showing that people who are deprived of dream sleep perform worse on tests of memory and learning the following day.", "B": "Some researchers believe that the most vivid dreams occur during the deepest stages of sleep.", "C": "Despite these advances, the precise function of dreaming remains one of the most debated questions in neuroscience.", "D": "For centuries, dreams were seen as messages from gods or glimpses into the future.", "E": "During this phase, brain activity increases dramatically and the eyes move rapidly beneath closed lids.", "F": "A third theory proposes that dreams are simply the brain's way of processing and discarding unnecessary information.", "G": "Scientists now generally agree that dreaming plays an important role in emotional regulation.", "H": "Children dream more frequently than adults, and their dreams tend to contain more animals and fantastical elements."}, "parts": ["Humans have been fascinated by dreams for as long as recorded history. [GAP1] Modern science has replaced these interpretations with more rigorous theories, but the mystery of why we dream has not been fully solved.", "Most dreaming takes place during a phase of sleep known as Rapid Eye Movement, or REM sleep. [GAP2] It is during REM sleep that the brain appears most active \u2014 in some ways resembling the waking brain more than it does deep, dreamless sleep.", "One of the most widely accepted theories is that dreaming helps consolidate memories and process the events of the day. [GAP3] When we dream, the brain may be replaying and organising experiences from our waking hours, deciding what to store and what to let go.", "[GAP4] Experiments with both humans and animals suggest that sleep \u2014 and particularly dream sleep \u2014 helps individuals process stressful or emotional events, reducing their psychological impact over time.", "[GAP5] Some scientists argue that dreaming serves no evolutionary purpose and is simply a by-product of the sleeping brain's activity. Others maintain that its benefits are real but difficult to measure. What nearly everyone agrees on is that sleep \u2014 with all its mysteries \u2014 is essential to health."], "gapIds": ["r16", "r17", "r18", "r19", "r20"], "answers": {"r16": "D", "r17": "E", "r18": "A", "r19": "G", "r20": "C"}},
    p5: {"inst": "Read the text and choose the correct word for each space.", "title": "The Future of Work", "text": "The way people work is changing faster than at any point in recent history. Remote working, once considered a privilege for a (21)___ number of professionals, became standard practice for millions of people almost overnight during the pandemic. Many workers discovered that they could be just as (22)___ at home as in an office \u2014 sometimes more so \u2014 and companies found that productivity did not (23)___ as they had feared. Now, as employers push for a return to offices, many workers are (24)___ to give up the flexibility they have grown accustomed to. The result is a new kind of negotiation between employers and employees about where, when and how work should (25)___. Experts predict that the future of work will look very different from the past \u2014 more flexible, more digital, and increasingly (26)___ on the ability to collaborate effectively across distances.", "qs": [{"id": "r21", "q": "(21)", "opts": {"A": "few", "B": "small", "C": "little", "D": "limited"}}, {"id": "r22", "q": "(22)", "opts": {"A": "effective", "B": "productive", "C": "useful", "D": "capable"}}, {"id": "r23", "q": "(23)", "opts": {"A": "drop", "B": "decrease", "C": "reduce", "D": "fall"}}, {"id": "r24", "q": "(24)", "opts": {"A": "happy", "B": "willing", "C": "reluctant", "D": "ready"}}, {"id": "r25", "q": "(25)", "opts": {"A": "happen", "B": "take place", "C": "be done", "D": "occur"}}, {"id": "r26", "q": "(26)", "opts": {"A": "based", "B": "focused", "C": "built", "D": "dependent"}}]},
    p6: {"inst": "Read the text and write ONE word for each space.", "title": "The History of Coffee", "text": "Few beverages have had as much influence on human history as coffee. Legend has it that the drink was first discovered in Ethiopia, (27)___ a goat herder noticed that his animals became unusually energetic after eating berries from a particular tree. (28)___ true or not, by the fifteenth century coffee was being cultivated and traded across the Arabian Peninsula. Coffeehouses \u2014 places where people gathered to drink, talk and exchange news \u2014 soon became important social spaces in cities across (29)___ the Middle East and Europe. In seventeenth-century London, these establishments were (30)___ to spread so rapidly that the king attempted to ban them, fearing they were centres of political discussion. His order was ignored. Today, coffee is the second most traded commodity in the world after oil, and the ritual of drinking it \u2014 (31)___ alone or with others \u2014 remains central to daily life in cultures across every continent. (32)___ despite its global ubiquity, each country has developed its own distinct coffee culture and traditions.", "r27": "while", "r28": "Whether", "r29": "both", "r30": "used", "r31": "whether", "r32": "And"},
    writing: {"p1inst": "You have received this email from your English-speaking friend, Chris.", "p1email": "From: Chris\nSubject: Thinking about the future!\n\nHi! I've been thinking a lot about what job I want to do when I'm older. Have you decided what you want to do? What do you think is more important when choosing a job \u2014 the salary, the enjoyment, or something else? And do you think it's important to do work experience while you're still at school?\n\nLet me know what you think!\nChris", "p1notes": ["What job you want to do", "What matters most when choosing a job", "Whether work experience at school is important"], "p1task": "Write an email to Chris answering all three questions. Write about 100 words.", "p2a_title": "Dreams and What They Mean", "p2a_prompt": "Your school magazine wants articles on the following question: 'Do you think dreams have meaning, or are they just random images produced by a sleeping brain?' Write an article giving your personal view with reasons and examples. Write about 100 words.", "p2b_first": "When the alarm went off at 3am, I knew something had gone seriously wrong."}
  },
};



// ═══════════════════════════════════════════════════
// BUILD EXAM
// ═══════════════════════════════════════════════════
function buildExam(ver) {
  var v = BANK[ver];
  activeKey = v.key;
  activeP6  = v.p6;
  buildReading(v);
  buildListening();
  buildWriting(v);
}

function el(tag, attrs, text) {
  var e = document.createElement(tag);
  if (attrs) Object.keys(attrs).forEach(function(k){ e.setAttribute(k, attrs[k]); });
  if (text !== undefined) e.textContent = text;
  return e;
}

function qBlock(id, num, qtext) {
  var d = el("div", {id:"qb-"+id, class:"qblock"});
  d.appendChild(el("div", {class:"qnum"}, "Question " + num));
  if (qtext) d.appendChild(el("div", {class:"qtext"}, qtext));
  return d;
}

function optRow(qid, letter, label) {
  var row = el("div", {class:"opt"});
  row.appendChild(el("div", {class:"opt-letter"}, letter));
  if (label) row.appendChild(el("span", {}, label));
  row.onclick = (function(id, l, r){ return function(){ pick(id, l, r); }; })(qid, letter, row);
  return row;
}

function buildReading(v) {
  var wrap = document.getElementById("reading-content");
  wrap.innerHTML = "";

  // P1
  var c1 = el("div", {class:"part-card"});
  c1.appendChild(el("div", {class:"part-title"}, "Part 1 – Signs & Short Messages"));
  c1.appendChild(el("div", {class:"part-sub"}, "Q1–5 · 5 marks"));
  c1.appendChild(el("div", {class:"instructions"}, v.p1.inst));
  v.p1.qs.forEach(function(q, i) {
    var b = qBlock(q.id, i+1, q.q);
    var sign = el("div", {class:"signbox"}, q.sign);
    b.insertBefore(sign, b.querySelector(".qtext"));
    var opts = el("div", {class:"opts"});
    ["A","B","C"].forEach(function(x){ opts.appendChild(optRow(q.id, x, q.opts[x])); });
    b.appendChild(opts);
    c1.appendChild(b);
  });
  wrap.appendChild(c1);

  // P2
  var c2 = el("div", {class:"part-card"});
  c2.appendChild(el("div", {class:"part-title"}, "Part 2 – Matching"));
  c2.appendChild(el("div", {class:"part-sub"}, "Q6–10 · 5 marks"));
  c2.appendChild(el("div", {class:"instructions"}, v.p2.inst));
  var actBox = el("div", {class:"ref-box"});
  actBox.appendChild(el("div", {class:"ref-box-title"}, "Activities / Options"));
  v.p2.acts.forEach(function(a) {
    var d = el("div", {class:"ref-item"});
    d.innerHTML = "<strong>" + a.l + ".</strong> <strong>" + a.title + "</strong> — " + a.desc;
    actBox.appendChild(d);
  });
  c2.appendChild(actBox);
  v.p2.people.forEach(function(p, i) {
    var b = qBlock(p.id, i+6, p.name + " — " + p.desc);
    var opts = el("div", {class:"opts", style:"grid-template-columns:repeat(4,1fr);"});
    ["A","B","C","D","E","F","G","H"].forEach(function(x){ opts.appendChild(optRow(p.id, x, "")); });
    b.appendChild(opts);
    c2.appendChild(b);
  });
  wrap.appendChild(c2);

  // P3
  var c3 = el("div", {class:"part-card"});
  c3.appendChild(el("div", {class:"part-title"}, "Part 3 – Long Text"));
  c3.appendChild(el("div", {class:"part-sub"}, "Q11–15 · 5 marks"));
  c3.appendChild(el("div", {class:"instructions"}, v.p3.inst));
  var artBox = el("div", {class:"ref-box"});
  artBox.appendChild(el("div", {class:"ref-box-title"}, v.p3.title));
  artBox.appendChild(el("div", {style:"font-size:0.88rem;line-height:1.8;white-space:pre-line;"}, v.p3.text));
  c3.appendChild(artBox);
  v.p3.qs.forEach(function(q, i) {
    var b = qBlock(q.id, i+11, q.q);
    var opts = el("div", {class:"opts"});
    ["A","B","C","D"].forEach(function(x){ opts.appendChild(optRow(q.id, x, q.opts[x])); });
    b.appendChild(opts);
    c3.appendChild(b);
  });
  wrap.appendChild(c3);

  // P4
  var c4 = el("div", {class:"part-card"});
  c4.appendChild(el("div", {class:"part-title"}, "Part 4 – Gapped Text"));
  c4.appendChild(el("div", {class:"part-sub"}, "Q16–20 · 5 marks"));
  c4.appendChild(el("div", {class:"instructions"}, v.p4.inst));
  var sentBox = el("div", {class:"ref-box"});
  sentBox.appendChild(el("div", {class:"ref-box-title"}, "Sentences A–H"));
  Object.keys(v.p4.sents).forEach(function(k) {
    var d = el("div", {class:"ref-item"});
    d.innerHTML = "<strong>" + k + ".</strong> " + v.p4.sents[k];
    sentBox.appendChild(d);
  });
  c4.appendChild(sentBox);
  var textBox4 = el("div", {style:"background:#fff;border:1px solid #d4c9a8;border-radius:8px;padding:18px;margin-bottom:16px;"});
  textBox4.appendChild(el("div", {style:"font-weight:700;color:#0a1628;margin-bottom:12px;"}, v.p4.title));
  var gapIds = ["r16","r17","r18","r19","r20"];
  var gn = 0;
  v.p4.parts.forEach(function(part) {
    if (part === "GAP") {
      var gid = gapIds[gn++];
      var b = el("div", {id:"qb-"+gid, class:"qblock", style:"margin:10px 0;"});
      b.appendChild(el("div", {class:"qnum"}, "Gap " + gn + " — choose A–H"));
      var opts = el("div", {class:"opts", style:"grid-template-columns:repeat(4,1fr);"});
      ["A","B","C","D","E","F","G","H"].forEach(function(x){ opts.appendChild(optRow(gid, x, "")); });
      b.appendChild(opts);
      textBox4.appendChild(b);
    } else {
      textBox4.appendChild(el("p", {style:"font-size:0.88rem;line-height:1.8;margin:8px 0;"}, part));
    }
  });
  c4.appendChild(textBox4);
  wrap.appendChild(c4);

  // P5
  var c5 = el("div", {class:"part-card"});
  c5.appendChild(el("div", {class:"part-title"}, "Part 5 – Multiple Choice Cloze"));
  c5.appendChild(el("div", {class:"part-sub"}, "Q21–26 · 6 marks"));
  c5.appendChild(el("div", {class:"instructions"}, v.p5.inst));
  var tb5 = el("div", {class:"ref-box"});
  tb5.appendChild(el("div", {class:"ref-box-title"}, v.p5.title));
  tb5.appendChild(el("div", {style:"font-size:0.88rem;line-height:1.85;"}, v.p5.text));
  c5.appendChild(tb5);
  v.p5.qs.forEach(function(q, i) {
    var b = qBlock(q.id, i+21, q.q);
    var opts = el("div", {class:"opts"});
    ["A","B","C","D"].forEach(function(x){ opts.appendChild(optRow(q.id, x, q.opts[x])); });
    b.appendChild(opts);
    c5.appendChild(b);
  });
  wrap.appendChild(c5);

  // P6
  var c6 = el("div", {class:"part-card"});
  c6.appendChild(el("div", {class:"part-title"}, "Part 6 – Open Cloze"));
  c6.appendChild(el("div", {class:"part-sub"}, "Q27–32 · 6 marks"));
  c6.appendChild(el("div", {class:"instructions"}, v.p6.inst));
  var tb6 = el("div", {style:"background:#fff;border:1px solid #d4c9a8;border-radius:8px;padding:18px;margin-bottom:16px;"});
  tb6.appendChild(el("div", {style:"font-weight:700;color:#0a1628;margin-bottom:10px;"}, v.p6.title));
  tb6.appendChild(el("div", {style:"font-size:0.88rem;line-height:2;"}, v.p6.text));
  c6.appendChild(tb6);
  var p6keys = Object.keys(v.p6);
  var p6num = 27;
  ["r27","r28","r29","r30","r31","r32"].forEach(function(kid) {
    var b = qBlock(kid, p6num, "Write ONE word for gap (" + p6num + "):");
    var inp = el("input", {type:"text", id:kid, placeholder:"one word...", class:"text-inp"});
    inp.oninput = (function(id){ return function(){ typeAnswer(id, this.value); }; })(kid);
    b.appendChild(inp);
    c6.appendChild(b);
    p6num++;
  });
  wrap.appendChild(c6);
}

function buildListening() {
  var wrap = document.getElementById("listening-content");
  wrap.innerHTML = "";
  var lqs = [
    {id:"l1", q:"L1 — What did the girl buy on her shopping trip?", opts:{A:"Bookcase / Shelves", B:"Lamp / Light", C:"Cushion / Pillow"}},
    {id:"l2", q:"L2 — Why did the plane leave late?", opts:{A:"Wind", B:"Snow", C:"Rain"}},
    {id:"l3", q:"L3 — What activity does the woman want to book?", opts:{A:"Rock climbing", B:"Kayaking", C:"Horse riding"}},
    {id:"l4", q:"L4 — Where will the school trip take place?", opts:{A:"The coast", B:"The mountains", C:"The city centre"}},
    {id:"l5", q:"L5 — What does the boy decide to wear to the party?", opts:{A:"Jeans and a T-shirt", B:"A suit", C:"Sports clothes"}},
    {id:"l6", q:"L6 — What time does the film start?", opts:{A:"7:15", B:"7:30", C:"7:45"}},
    {id:"l7", q:"L7 — What did the family do on holiday?", opts:{A:"Visited museums", B:"Went to the beach", C:"Stayed at home"}},
    {id:"l8", q:"L8 — The boy says the English test was ...", opts:{A:"easy", B:"difficult", C:"fair"}},
    {id:"l9", q:"L9 — What does the girl want to be when she grows up?", opts:{A:"A doctor", B:"A teacher", C:"An engineer"}},
    {id:"l10",q:"L10 — How does the man travel to work every day?", opts:{A:"By bus", B:"By bike", C:"By car"}},
    {id:"l11",q:"L11 — What is the weather like this afternoon?", opts:{A:"Sunny", B:"Cloudy", C:"Rainy"}},
    {id:"l12",q:"L12 — Why is the library closed?", opts:{A:"It is being repaired.", B:"It is a public holiday.", C:"There are no staff available."}},
    {id:"l13",q:"L13 — What subject does the boy find most difficult?", opts:{A:"Maths", B:"History", C:"Science"}}
  ];
  var shortAns = [
    {id:"l14",q:"L14 — What is the name of the new sports centre? Write the FULL NAME:"},
    {id:"l15",q:"L15 — What time does the bus to the airport leave? Write the TIME:"},
    {id:"l16",q:"L16 — How much does a student ticket cost? Write the PRICE:"},
    {id:"l17",q:"L17 — What is the name of the street where the hotel is? Write the NAME:"},
    {id:"l18",q:"L18 — How many students are in the exchange group? Write the NUMBER:"},
    {id:"l19",q:"L19 — What is the password for the school Wi-Fi? Write the PASSWORD:"},
    {id:"l20",q:"L20 — What date is the school concert? Write the DATE:"},
    {id:"l21",q:"L21 — What is the name of the teacher organising the trip?"},
    {id:"l22",q:"L22 — How long is the train journey? Write in minutes or hours:"},
    {id:"l23",q:"L23 — What must students bring to the science lesson? Write the ITEM:"},
    {id:"l24",q:"L24 — What floor is the headteacher's office on? Write the FLOOR:"},
    {id:"l25",q:"L25 — What is the topic of the school radio programme? Write the TOPIC:"}
  ];

  lqs.forEach(function(q) {
    var b = qBlock(q.id, q.id.replace("l","L"), q.q);
    var opts = el("div", {class:"opts"});
    ["A","B","C"].forEach(function(x){ opts.appendChild(optRow(q.id, x, q.opts[x])); });
    b.appendChild(opts);
    wrap.appendChild(b);
  });
  shortAns.forEach(function(q) {
    var b = qBlock(q.id, q.id.replace("l","L"), q.q);
    var inp = el("input", {type:"text", id:q.id, placeholder:"Write your answer...", class:"text-inp"});
    inp.oninput = (function(id){ return function(){ answers[id] = this.value; }; })(q.id);
    b.appendChild(inp);
    wrap.appendChild(b);
  });
}

function buildWriting(v) {
  var wrap = document.getElementById("writing-content");
  wrap.innerHTML = "";
  var w = v.writing;

  var c1 = el("div", {class:"part-card"});
  c1.appendChild(el("div", {class:"part-title"}, "Writing Part 1 – Email (compulsory)"));
  c1.appendChild(el("div", {class:"instructions"}, w.p1inst));
  var emailBox = el("div", {class:"signbox"}, w.p1email);
  c1.appendChild(emailBox);
  var noteBox = el("div", {style:"background:#fff;border:1px solid #d4c9a8;border-radius:6px;padding:12px;margin-bottom:12px;font-size:0.85rem;"});
  noteBox.innerHTML = "<strong>Notes:</strong><ul style='margin:8px 0 0 16px;'>" + w.p1notes.map(function(n){ return "<li>" + n + "</li>"; }).join("") + "</ul>";
  c1.appendChild(noteBox);
  c1.appendChild(el("div", {class:"qtext"}, w.p1task));
  var ta1 = el("textarea", {id:"writing1", class:"writing-area", rows:"8", placeholder:"Write your email here..."});
  ta1.oninput = function(){ updateWC(this, "wc1"); };
  c1.appendChild(ta1);
  c1.appendChild(el("div", {class:"wc"}, "Words: 0")).id = "wc1-wrap";
  var wc1 = el("div", {class:"wc"});
  wc1.innerHTML = "Words: <span id='wc1'>0</span>";
  c1.appendChild(wc1);
  wrap.appendChild(c1);

  var c2 = el("div", {class:"part-card"});
  c2.appendChild(el("div", {class:"part-title"}, "Writing Part 2 – Choose ONE"));

  var opt1 = el("div", {style:"border:2px solid #d4c9a8;border-radius:8px;padding:16px;margin-bottom:14px;"});
  opt1.appendChild(el("div", {style:"font-weight:700;font-size:0.9rem;color:#0a1628;margin-bottom:8px;"}, "Option A – " + w.p2a_title));
  opt1.appendChild(el("div", {class:"qtext"}, w.p2a_prompt));
  var ta2 = el("textarea", {id:"writing2", class:"writing-area", rows:"7", placeholder:"Write your article here..."});
  ta2.oninput = function(){ updateWC(this, "wc2"); };
  opt1.appendChild(ta2);
  var wc2 = el("div", {class:"wc"}); wc2.innerHTML = "Words: <span id='wc2'>0</span>";
  opt1.appendChild(wc2);
  c2.appendChild(opt1);

  var opt2 = el("div", {style:"border:2px solid #d4c9a8;border-radius:8px;padding:16px;"});
  opt2.appendChild(el("div", {style:"font-weight:700;font-size:0.9rem;color:#0a1628;margin-bottom:8px;"}, "Option B – Story"));
  opt2.appendChild(el("div", {class:"qtext"}, "Your story must begin with:"));
  opt2.appendChild(el("div", {style:"background:#f0ead8;border-left:3px solid #c8a84b;padding:10px 14px;margin:10px 0;font-style:italic;border-radius:0 6px 6px 0;"}, w.p2b_first));
  var ta3 = el("textarea", {id:"writing3", class:"writing-area", rows:"7", placeholder:"Continue the story here..."});
  ta3.oninput = function(){ updateWC(this, "wc3"); };
  opt2.appendChild(ta3);
  var wc3 = el("div", {class:"wc"}); wc3.innerHTML = "Words: <span id='wc3'>0</span>";
  opt2.appendChild(wc3);
  c2.appendChild(opt2);

  wrap.appendChild(c2);
}

function updateWC(ta, spanId) {
  var w = ta.value.trim() ? ta.value.trim().split(/\s+/).length : 0;
  var sp = document.getElementById(spanId);
  if (sp) sp.textContent = w;
}

</script>
</body>
</html>